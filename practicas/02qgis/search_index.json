[["index.html", "Cartografía con QGIS Sistemas de Información Geográfica 1 Introducción", " Cartografía con QGIS Sistemas de Información Geográfica José Samos Jiménez (jsamos@ugr.es) Dpto. de Lenguajes y Sistemas Informáticos Universidad de Granada Curso 2024-2025 https://doi.org/10.6084/m9.figshare.26965087.v1 Vídeo: https://youtu.be/Q9eKZF2vcQA 1 Introducción QGIS es un Sistema de Información Geográfica libre y de Código Abierto1. Es un proyecto oficial de Open Source Geospatial Foundation (OSGeo) impulsado por voluntarios. Funciona sobre Linux, Unix, Mac OSX, Windows y Android. Soporta datos vectoriales y ráster, en gran numero de formatos. Objetivos Repasar conceptos sobre Información Geográfica explicados en clase de Teoría, materializados en un SIG concreto. Introducir QGIS mediante ejemplos. No es una introducción exhaustiva sino un primer contacto; se pondrá en práctica: Cambio de idioma. Definición de carpetas favoritas. Instalación y uso de complementos. Visualización de capas. Realizar consultas sobre las capas. Generar una nueva capa como resultado de una consulta. Crear un mapa temático. Las actividades propuestas se basan principalmente en MIT GIS (2016), algunos aspectos de manejo de QGIS están basados en Graser (2016). Estructura del documento El documento se organiza en diversos apartados que presentan la funcionalidad de la herramienta, finalizando con una sección de ejercicios basados en los contenidos previamente expuestos. Dichos ejercicios deberán ser resueltos y entregados en formato PDF a través de la plataforma PRADO. La información proporcionada en los apartados debe ser suficiente para permitir la correcta resolución de los ejercicios. Referencias Graser, Anita. 2016. Learning QGIS. 3rd ed. Packt Publishing. MIT GIS, Services Group. 2016. RES.STR-001 Geographic Information System (GIS) Tutorial. January IAP 2016. Massachusetts Institute of Technology: MIT OpenCourseWare, https://ocw.mit.edu. https://www.qgis.org/es/site/↩︎ "],["obtencion-datos-qgis1.html", "2 Obtención de los datos", " 2 Obtención de los datos Vamos a trabajar con datos elaborados a partir de datos obtenidos de IDE (2017) e INE (2019) para los municipios de la provincia de Granada hasta el año 2018, disponibles en https://doi.org/10.6084/m9.figshare.11295644. Vamos a completar estos datos con otros obtenidos del INE (Instituto Nacional de Estadística), de 2019 en adelante. Para cada municipio de Granada, obtendremos los datos del número de mujeres y hombres contabilizados cada 1 de Enero, desde el año 2019 hasta el último año publicado. Figura 2.1: Descarga de datos del Padrón municipal (INE). Los datos de las distintas provincias se pueden obtener del INE, cuya página se muestra en la figura 2.1. Pulsando sobre el enlace de la provincia de Granada (Granada: Población por municipios y sexo), accedemos a la pantalla de consulta para sus datos. Figura 2.2: Configuración de la consulta. La figura 2.2 muestra la pantalla de configuración de la consulta: en ella podemos seleccionar los valores a consultar y la configuración de cabeceras de filas y columnas. En particular, seleccionamos los años posteriores a 2018 en el campo Periodo y todos los valores del campo Sexo. Todos los valores del campo Municipios están seleccionados. En lo que se refiere a la forma de presentación de la tabla, dejamos el campo Municipios en la filas y, pulsando-arrastrando-soltando, definimos Periodo y Sexo en la columnas. A continuación, pulsamos sobre el botón Consultar selección (figura 2.2). Figura 2.3: Resultado de la consulta. En la figura 2.3 se muestra el resultado de la consulta para los datos disponibles en 2021. Descargamos el resultado en forma de archivo pulsando sobre el botón Descargar (en la parte superior derecha). Nos permite seleccionar el formato de los datos. Si queremos que se conserve la estructura de la tabla, debemos seleccionar uno de los formatos de Excel2. Figura 2.4: Resultado de la consulta en Excel. La figura 2.4 muestra parte del contenido del archivo Excel obtenido. La tabla tiene una cabecera y un pie (no mostrado en la figura) que debemos eliminar. Adicionalmente, cada columna debe tener un nombre de campo adecuado, como combinación de los datos que muestra. Figura 2.5: Resultado de la consulta en Excel modificado. En la figura 2.5 podemos ver parte del contenido del archivo Excel una vez modificado: se le ha añadido el nombre a cada columna en función de los datos que contiene, en particular, para los datos del censo se incluye el periodo y una letra para cada valor del campo Sexo (T, H y M para Total, Hombres y Mujeres, respectivamente). También se han eliminado las filas que componen el pie de la tabla. Estos datos se han obtenido de la forma descrita y están disponibles en https://doi.org/10.6084/m9.figshare.11295644 para facilitar su uso. Referencias IDE, Andalucía. 2017. Infraestructura de Datos Espaciales de Andalucía. Junta de Andalucía, http://www.ideandalucia.es. INE. 2019. INEbase / Nomenclátor: Población Del Padrón Continuo Por Unidad Poblacional. Instituto Nacional de Estadística, http://www.ine.es/nomen2/index.do. Si usamos la versión 3 de QGIS, deberemos descargar el archivo en formato xlsx ya que en formato xls no permite modificar los datos de la tabla.↩︎ "],["entorno-de-trabajo.html", "3 Entorno de trabajo 3.1 Cambiar el idioma 3.2 Configuración de la pantalla principal 3.3 Ubicación de los datos 3.4 Añadir la carpeta de trabajo a Favoritos 3.5 Guardar el proyecto", " 3 Entorno de trabajo Iniciamos QGIS Desktop. Las capturas de pantalla incluidas en este documento corresponden a la versión 3.18.3. Las indicaciones son válidas también para la versión 2. Para esta actividad, la principal diferencia entre las versiones 2 y 3 está en los componentes adicionales disponibles. 3.1 Cambiar el idioma Al instalarse, QGIS considera el idioma del sistema. En esta actividad, usaremos el Español. Los libros o tutoriales sobre QGIS más abundantes están en Inglés. Generalmente es más fácil seguir el material sobre una herramienta si esta está en el mismo idioma que las pantallas u opciones que se presentan. Por este motivo, es posible que en algún caso nos interese cambiar el idioma de QGIS (por ejemplo, si está en Español, ponerlo en Inglés y viceversa). Figura 3.1: Acceso a las opciones de configuración. Para acceder a la opción de cambiar el idioma de la aplicación, pulsamos sobre Configuración &gt; Opciones…, como se muestra en la figura 3.1. Figura 3.2: Cambiar el idioma. En la ventana que se abre, en el apartado General3, marcamos la opción Override System Locale y elegimos el idioma deseado en el campo User interface translation, como se muestra en la figura 3.2. Si fuese necesario, podemos cambiar la configuración regional (formatos de números, fecha y moneda) en el campo correspondiente de ese mismo apartado. Para que tengan efecto los cambios, hay que reiniciar la aplicación. 3.2 Configuración de la pantalla principal Figura 3.3: Pantalla Principal. En la figura 3.3 se muestra la pantalla principal de QGIS. El área de trabajo está compuesta por varios paneles. Uno central, dividido en dos partes, cuyos títulos son Proyectos recientes y Project templates, donde se mostrará el resultado de las operaciones que realicemos; otros opcionales, Navegador y Capas, que pueden moverse o cerrarse. El Navegador nos permite seleccionar capas de datos de distintas fuentes para trabajar con ellas. El panel Capas nos permite gestionar y organizar la capas que hemos seleccionado para representar. Figura 3.4: Selección de paneles del entorno de trabajo. Podemos ocultar estos paneles o bien mostrar otros disponibles pulsando sobre Ver &gt; Paneles (figura 3.4). 3.3 Ubicación de los datos Figura 3.5: Shapefiles en la carpeta de trabajo. Hemos descomprimido los datos facilitados4 en una carpeta de trabajo. Se trata de tres capas en formato shapefile que, como se puede ver en la figura 3.5, es un formato de datos multiarchivo. Figura 3.6: Shapefiles en la ventana Navegador. Para representar una capa en QGIS, podemos pulsar-arrastrar-soltar el archivo .shp, componente del shapefile, sobre la ventana de Capas o sobre la ventana Proyectos recientes (la ventana central). También se puede hacer esta operación (representar una capa) de una forma más adecuada desde la ventana Navegador, que nos permite navegar por el árbol de carpetas representando cada capa en formato shapefile como un solo archivo (figura 3.6). 3.4 Añadir la carpeta de trabajo a Favoritos Figura 3.7: Añadir carpeta a Favoritos. Si la carpeta de trabajo la vamos a usar para almacenar las capas que vamos a utilizar, podemos facilitar su acceso posterior añadiéndola al apartado Favoritos del Navegador. Esta operación se puede hacer desde el menú contextual de la carpeta, en la ventana Navegador, seleccionando la opción Añadir como favorito (figura 3.7). 3.5 Guardar el proyecto Para guardar nuestro proyecto pulsamos sobre Proyecto &gt; Guardar o Proyecto &gt; Guardar como, seleccionamos una carpeta de trabajo y le asignamos un nombre al proyecto. Guarda los datos en un archivo de extensión .qgz. En la versión 2 de QGIS, hay un apartado específico Idioma.↩︎ https://doi.org/10.6084/m9.figshare.11295644.v1↩︎ "],["representación-de-capas.html", "4 Representación de capas 4.1 Coordinate Reference Systems (CRS) 4.2 Añadir capas 4.3 Cambiar la representación de una capa 4.4 Acercar o alejar las capas 4.5 Complementos", " 4 Representación de capas En este apartado se explican los aspectos a tener en cuenta para añadir capas para ser representadas conjuntamente en QGIS. 4.1 Coordinate Reference Systems (CRS) Figura 4.1: CRS del proyecto. Para representar las capas, cada proyecto en QGIS utiliza un sistema de referencia de coordenadas (CRS) identificado por un código numérico que se puede ver en la parte derecha de la barra de estado inferior. Pulsando clic sobre ese número se abre una ventana donde muestra los detalles del CRS y puede cambiarse, si se considera necesario (figura 4.1). También se puede acceder a la misma ventana pulsando sobre la opción Proyecto &gt; Propiedades y, a continuación, sobre la pestaña SRC. En este caso no vamos a cambiar explícitamente el CRS del proyecto, por lo que podemos cerrar la ventana de propiedades, si la hemos abierto. 4.2 Añadir capas Para añadir una capa, podemos pulsar-arrastrar-soltar el archivo .shp sobre la ventana de Capas o sobre la ventana de presentación. Una forma alternativa de añadir las capas que se muestran en el Navegador es pulsando doble-clic sobre el nombre de la capa. Una vez tenemos los archivos en el apartado Favoritos del Navegador. Esta operación es muy fácil de realizar porque se muestra directamente la carpeta (en lugar del árbol de carpetas) y solo vemos el componente .shp. Cuando añadimos la primera capa, como sus datos están representados mediante un CRS y el proyecto usa otro distinto, nos muestra una ventana con varias posibilidades de transformación (figura 4.2). Figura 4.2: Transformar el CRS de la capa que se añade. Al seleccionar cualquiera de las transformaciones, nos muestra el área de uso de los datos. Se supone que cada transformación resulta más adecuada para un área geográfica específica y podemos seleccionar la que corresponda a nuestra área de trabajo5. Figura 4.3: Representación inicial de las capas. Si añadimos el resto de capas, como tienen el mismo CRS que el nuevo CRS del proyecto, ya no nos muestra la ventana de transformación. Las capas que se están representando se pueden ver en la ventana Capas (figura 4.3). El resultado de la representación depende del orden de las capas en la lista: el orden de representación es de abajo hacia arriba. Podemos cambiar el orden de las capas pulsando-arrastrando-soltando una capa en esta lista hasta su nueva ubicación en la lista. Se puede desactivar cualquier capa pulsado sobre la casilla de verificación que aparece a la izquierda de su nombre (figura 4.3), el resultado en la representación es equivalente a que la capa no se hubiera añadido. También podemos eliminar una capa mediante la opción Eliminar capa… del menú contextual de la capa. Una operación que se usa con frecuencia es cambiar el nombre de una capa, ya que el nombre por defecto se basa en el nombre del archivo que la contiene. Se puede hacer directamente desde el menú contextual de la capa, seleccionando la opción Cambiar nombre de la capa. El cambio de nombre tiene efectos solo en QGIS: el archivo de la capa no se ve afectado. 4.3 Cambiar la representación de una capa Figura 4.4: Representación inicial de las capas. Los colores utilizados para representar las capas son asignados de forma aleatoria al añadirlas pero se pueden cambiar desde la ventana de propiedades de la capa, accesible desde la opción Propiedades de su menú contextual o pulsando doble-clic sobre el nombre de la capa, desde el apartado Simbología (figura 4.4). Una capa podemos añadirla varias veces: en la ventana Capas son capas distintas. Para cada capa añadida podemos definir una representación, por ejemplo cambiando los niveles de transparencia del relleno (también se define desde el apartado Simbología, en la figura 4.4 el campo Opacidad). 4.4 Acercar o alejar las capas Figura 4.5: Escala en la barra de estado. Al añadir la primera capa, QGIS adapta la escala de representación para que se muestre en su totalidad. La escala de representación puede verse en la barra de estado inferior (figura 4.5). Se puede cambiar de escala en la propia barra de estado, generalmente se suele definir una escala con valores redondos (p.e, 1:1000000 en lugar de 1:1028903). Figura 4.6: Opciones de zoom en la barra de herramientas. También se puede cambiar la escala mediante las distintas opciones de zoom disponibles en la barra de herramientas, representadas mediante un icono en forma de lupa con distintos elementos adicionales (figura 4.6). Además de acercar o alejar el punto de vista, podemos hacer Zoom general para mostrar todas las capas, Zoom a la selección y Zoom a la capa (asimismo, se puede acceder a estas operaciones desde el menú contextual de la capa). Adicionalmente, podemos movernos por las operaciones zoom realizadas mediante Zoom último y Zoom siguiente. 4.5 Complementos La funcionalidad básica de QGIS se amplía mediante complementos (plugins). En particular, si queremos importar un ráster de la zona de trabajo desde la Web podemos usar la funcionalidad del complemento QuickMapServices6. Figura 4.7: Administrar e instalar complementos. Para gestionar los complementos (ver los que están instalados, ver todos los disponibles, instalar, desinstalar, actualizar, activar y desactivar), pulsamos sobre Complementos &gt; Administrar e instalar complementos… (figura 4.7). También podemos desarrollar nuestros propios complementos e, incluso, aportarlos a la comunidad QGIS. Se desarrollan en Python7. Figura 4.8: Instalar el complemento QuickMapServices. Para usar QuickMapServices tenemos que instalarlo. Podemos buscarlo en el apartado Todos empezando a escribir su nombre (figura 4.8), lo seleccionamos y pulsamos sobre Instalar complemento. Figura 4.9: Opciones del complemento QuickMapServices en el menú y en la barra de herramientas. El resultado de la instalación del complemento lo podemos ver en la figura 4.9: se ha añadido un nuevo menú en Web &gt; QuickMapServices, también varios iconos en la barra de herramientas. Nos ofrece distintas fuentes de donde obtener rásteres asociados a nuestros datos. Podemos probar cualquiera de ellas. Figura 4.10: Ampliar la lista de mapas base. Para obtener más mapas base, ve a QuickMapServices &gt; Settings, en la pestaña More services, haz clic en Get contributed pack (figura 4.10). Esto añadirá más opciones de mapas base de diferentes proveedores, como Google Satellite, Bing Aerial, entre otros. Figura 4.11: Resultado de buscar y añadir una capa ráster con una imagen de satélite. En particular, en la figura 4.11, se muestra el resultado de utilizar la operación Search QMS para buscar imágenes de satélite y añadir una de ellas como una capa (pulsando sobre el botón Add en la columna de la derecha). Para mejorar el resultado, se ha definido un cierto nivel de transparencia en la capa de los municipios. En este caso, el resultado es el mismo independientemente de la transformación seleccionada o si, en lugar de seleccionar una transformación, pulsamos sobre el botón Cancelar: el CRS de la primera capa que añadimos, pasa a ser el del proyecto.↩︎ En la versión 2 de QGIS, esta funcionalidad la ofrece el complemento OpenLayers.↩︎ https://www.qgistutorials.com/en/docs/building_a_python_plugin.html↩︎ "],["explorar-una-capa.html", "5 Explorar una capa 5.1 Identificar elementos de una capa 5.2 Seleccionar elementos mediante la tabla de atributos", " 5 Explorar una capa Para explorar un capa, debemos seleccionarla previamente en la ventana Capas, pulsando clic sobre su nombre. 5.1 Identificar elementos de una capa Figura 5.1: Identificar objetos espaciales. Podemos identificar los elementos representados en una capa mediante la opción Identificar objetos espaciales (figura 5.1). Figura 5.2: Datos de un objeto espacial. Una vez activada dicha opción (pulsando sobre ella en la barra de herramientas) cambia el puntero del ratón. Si pulsamos sobre cualquier elemento del mapa, muestra, a la derecha de la pantalla, la ventana Resultados de la identificación con los datos disponibles de dicho elemento (figura 5.2). También se pueden seleccionar varios elementos a la vez, pulsando-arrastrando-soltando para definir un rectángulo. En la ventana Resultados de la identificación se muestran los valores de los campos de la capa para los objetos seleccionados. En concreto, la capa de municipios tiene definidos campos para el nombre y código del municipio (municipio y cod_mun), de la provincia (provincia), la longitud (\\(m\\)) y el área (\\(m^2\\)) del polígono que define su contorno (shape_len y shape_area), la superficie en \\(Km^2\\) (Superficie) y datos del censo de habitantes, desde 2014 a 2018, el número de hombres, mujeres y total (representado mediante los sufijos H, M y T respectivamente): por ejemplo, Ce2018T es el número total de personas del municipio censadas en el año 2018. Para dejar de realizar esta operación, debemos pulsar sobre el icono Limpiar resultados de la ventana Resultados de la identificación (figura 5.2). 5.2 Seleccionar elementos mediante la tabla de atributos Figura 5.3: Abrir la tabla de atributos. Podemos mostrar la tabla de atributos de una capa seleccionando la opción Abrir tabla de atributos del menú contextual de la capa o bien pulsado sobre el icono correspondiente de la barra de herramientas (figura 5.3). La tabla de atributos contiene los campos y valores que se muestran al identificar un objeto espacial, para todos los objetos de la capa. Figura 5.4: Tabla de atributos. Pulsando sobre cualquier número en el borde izquierdo de la tabla (figura 5.4), seleccionamos el elemento correspondiente de la tabla y este se muestra en la representación de la capa. Si mantenemos pulsada la tecla Ctrl mientras pulsamos elementos, podemos seleccionar varios elementos a la vez. La tabla de atributos tiene su propia barra de herramientas que permite realizar selección de registros por varios métodos. Asimismo, nos permite dejar de aplicar la selección que se esté realizando, mediante Deselect all features from the layer (figura 5.4). "],["operaciones-sobre-la-tabla-de-atributos.html", "6 Operaciones sobre la tabla de atributos 6.1 Capas con solo tabla de atributos 6.2 Añadir un campo a la tabla de atributos 6.3 Unir tablas de atributos 6.4 Consultas sobre la tabla de atributos 6.5 Guardar una capa", " 6 Operaciones sobre la tabla de atributos Una vez mostrada la selección de registros de la tabla de atributos, en este apartado vamos a realizar varias operaciones de modificación de la misma. 6.1 Capas con solo tabla de atributos Figura 6.1: Capa de tabla de atributos. Cada capa tiene su propia tabla de atributos pero también podemos tener capas con solo la tabla de atributos, sin elementos geométricos. Si añadimos una de estas capas a la ventana Capas, no cambia nada en la representación que realiza QGIS. En la figura 6.1, se muestra la tabla de atributos de la capa con los datos del censo de los municipios de Granada para los últimos años. Como veremos a continuación, podemos trabajar con estos datos para combinarlos con otras capas, por eso necesitamos añadirlos al conjunto de capas. Para este caso en particular, nos interesará combinar los datos del censo actuales con los almacenados en la capa de municipios, que contiene los datos del censo desde 2014 a 2018 asociados a información geográfica de los municipios. 6.2 Añadir un campo a la tabla de atributos Se puede modificar la tabla de atributos de cualquier capa. Una de las modificaciones más frecuentes es añadir un campo nuevo definido a partir de otros campos. En este ejemplo, vamos a modificar la tabla de atributos de la capa que solo contiene esa tabla. Todas las tablas de atributos se modifican de la misma forma. Figura 6.2: Conmutar el modo edición. Para modificar la tabla de atributos de una capa, en primer lugar debemos pulsar sobre el icono Conmutar el modo edición (figura 6.2), así se activan los iconos de las operaciones de modificación no activos previamente8. Figura 6.3: Abrir calculadora de campos. Para añadir un nuevo campo a partir de otros, podemos usar la calculadora de campos. Para ello pulsamos sobre el icono Abrir calculadora de campos de la barra de herramientas de la tabla de atributos (figura 6.3). Figura 6.4: Calculadora de campos. Mediante la calculadora de campos, definimos el nombre y tipo del nuevo campo, así como la expresión para obtener sus valores. En la definición de esta función podemos usar funciones de varios tipos y los valores de otros campos (figura 6.4). Por ejemplo, si queremos obtener el código de cada municipio, observamos que corresponde a las 5 primeras posiciones del campo Municipio9, se pueden obtener mediante la función substr, disponible en el grupo de funciones Cadena. Figura 6.5: Resultado de la definición de un campo calculado. El resultado obtenido se muestra en la figura 6.5: la tabla incluye una nueva columna con el nombre definido (Código) y los valores devueltos por la función asociada. Al añadir un campo a la tabla de atributos en una capa de la ventana Capas el campo se añade físicamente al archivo de la capa, es decir, se modifica el archivo original de la capa. 6.3 Unir tablas de atributos Para unir dos tablas de atributos, estas deben compartir algún campo con valores en común, los nombres de los campos utilizados para definir la unión no es relevante. Figura 6.6: Operación de unión en la ventana Layer Properties de una capa. La operación de unión se define desde el apartado Uniones en la ventana Layer Properties de la capa donde queremos que quede el resultado de la operación (figura 6.6). En este caso, vamos a completar los datos de la capa de municipios con los datos actuales obtenidos de censo. Para definir una nueva unión, pulsamos sobre el botón Añadir unión nueva, como resultado se abre la ventana Añadir unión vectorial. Figura 6.7: Ventana de definición de la unión. En la ventana Añadir unión vectorial (figura 6.7), seleccionamos la capa con la que vamos a definir la unión y los campos que comparten valores, en este caso, los campos que contienen los códigos de los municipios. Los campos de la tabla seleccionada se añadirán a la tabla de la capa. Para evitar repeticiones en los nombres y diferenciarlos, se puede definir un prefijo, por defecto, compuesto por el nombre de la tabla. En este caso, no necesitamos ningún prefijo, por lo que marcamos la opción Prefijo de nombre de campo personalizado y eliminamos el prefijo definido por defecto. Figura 6.8: Resultado de la unión definida. Al pulsar sobre el botón Aceptar, la unión queda definida. Podemos modificarla o eliminarla, si fuese necesario. También podemos definir más uniones a partir de la misma tabla (figura 6.8). Figura 6.9: Organizar las columnas de la tabla de atributos. El resultado de la unión lo podemos ver abriendo la tabla de atributos: añade las columnas de la tabla seleccionada al final de la tabla, con los valores asociados según los campos considerados para definir la operación. Podemos modificar la operación de unión, por ejemplo, para añadir un prefijo personalizado a las nuevas columnas de la tabla (o eliminarlo, si lo añade por defecto). En caso de no necesitar todos los campos añadidos, o bien, considerar más adecuado otro orden en ellos, podemos pulsar sobre el icono Organize columns de la tabla de atributos (figura 6.9). Figura 6.10: Ventana de organización de columnas de la tabla de atributos. Como resultado, se abre la ventana Organizar columnas de la tabla, que permite deseleccionar las columnas que no queramos que se muestren o bien cambiar el orden de presentación de estas. Por ejemplo, aunque el orden no sea relevante, podemos querer tenerlas ordenadas según el año (figura 6.10). Figura 6.11: Tabla de atributos resultado de la unión. En la figura 6.11, se muestra la tabla de atributos de la capa de municipios resultado de la unión, después de haber reorganizado las columnas. En ella tenemos los datos del censo actualizados. Sería de esperar que la tabla de atributos tal y como está definida en la figura 6.11 fuese la tabla de atributos de la capa en todas las operaciones. Como veremos a continuación, en algunas situaciones no es así: se distingue entre los atributos propios y los definidos como resultado de la unión y no permite trabajar con ellos, no se mantiene el orden definido en la reorganización de los atributos. 6.4 Consultas sobre la tabla de atributos Supongamos que queremos seleccionar los municipios cuya población haya aumentado durante el último año. Podemos definir consultas de filtrado de filas sobre la tabla de atributos de una capa mediante el Constructor de consultas. Figura 6.12: Acceso al Constructor de consultas. Para definir una consulta sobre una capa, abrimos la ventana Layer Properties de la capa y, en el apartado Fuente, en la esquina inferior derecha, pulsamos sobre el botón Constructor de consultas (figura 6.12). Figura 6.13: Ventana del Constructor de consultas. En la ventana del Constructor de consultas (figura 6.13), podemos ver que, en el apartado Campos, solo aparecen los campos originales de la tabla de atributos, no aparecen los campos obtenidos mediante la unión con la tabla de datos actuales del censo. Una posibilidad para definir la consulta deseada (municipios cuya población haya aumentado durante el último año) es añadir un campo Incremento a la tabla de atributos, definido como la diferencia de población entre los dos últimos años, y definir la consulta sobre él. Figura 6.14: Ventana del Constructor de consultas con un nuevo campo añadido. Una vez realizada esta operación, ahora podemos ver en la ventana del Constructor de consultas (figura 6.14) que aparece el nuevo campo Incremento añadido. Aunque está definido a partir campos de la tabla obtenidos mediante la operación de unión, este campo se añade a la tabla y es accesible desde el Constructor de consultas. Podemos consultar los valores de un campo seleccionándolo en la ventana Campos y pulsando sobre los botones Muestra o Todos. Pulsando doble-clic sobre un campo, se añade a la ventana Provider Specific Filter Expression para definir la expresión de filtro. Completamos la expresión pulsando sobre los botones de los operadores y/o sobre los valores de la ventana Valores o tecleando los operadores y valores necesarios. Si pulsamos sobre el botón Probar, nos muestra en una ventana el número de filas que cumplen la condición, resultado de la consulta. Figura 6.15: Resultado del Constructor de consultas. En la figura 6.15, se muestra el resultado de la definición de la consulta: en la ventana Filtro de objeto del proveedor se muestra el filtro definido. Figura 6.16: Resultado del Constructor de consultas en la ventana Capas. Una vez aceptamos las modificaciones y cerramos esta ventana, en la ventana Capas, a la derecha del nombre de la capa, se muestra el símbolo de un filtro y, al situar el ratón sobre él, se muestra la definición del filtro (figura 6.16). Si abrimos la tabla de atributos de la capa, podemos comprobar que solo contiene las filas que cumplen la condición definida. 6.5 Guardar una capa Figura 6.17: Guardar una capa en un archivo. Para guardar una capa en un archivo, seleccionamos la capa y pulsamos sobre la opción Capa &gt; Guardar como… (figura 6.17). Figura 6.18: Datos para guardar una capa en un archivo. En la ventana que se abre (figura 6.18), en el campo Formato, seleccionamos el formato de la nueva capa; en el campo Nombre de archivo, seleccionamos la ubicación y definimos el nombre del archivo; podemos cambiar el CRS de la capa en el campo SRC, en este caso se recalculan las coordenadas de acuerdo con el CRS seleccionado; en el campo Codificación podemos definir la codificación de los datos almacenados; asimismo, podemos seleccionar los campos que queremos almacenar10. Si seleccionamos la opción Añadir archivo guardado al mapa, la nueva capa se añade automáticamente a la ventana Capas. Aspectos importantes a tener en cuenta al guardar una capa son los siguientes: Esta es la manera de obtener una capa con un CRS distinto del original recalculando las coordenadas (si se cambia en las propiedades de la capa, se asigna el nuevo CRS a las coordenadas almacenadas). Solo se almacenarán los registros seleccionados en ese momento. Es decir, si mediante la definición de un filtro hemos realizado una selección de registros de la tabla de atributos, la nueva capa guardada solo incluirá esos registros. La tabla de atributos de la nueva capa incluirá todas las columnas de la tabla actual, también las procedentes de la operación de unión con otras tablas, aunque en la organización de columnas las hayamos definido como no visibles, sin tener en cuenta tampoco el orden definido. En este caso, nos puede interesar guardar una nueva versión de la capa original que contenga todos los campos y todas las filas, y otra versión que contenga solo las filas filtradas. Es decir, deberíamos eliminar el filtro definido. Para no tener que deshacer y repetir el trabajo ya realizado, podemos usar la operación Capa &gt; Duplicar capa(s) (también disponible en el menú contextual de la capa), para añadir una copia de la capa a la ventana Capas. Podemos modificar una de las copias de la capa eliminando el filtro definido (abriendo el Constructor de consultas de la capa y pulsando sobre el botón Limpiar) y guardar cada una de las capas así obtenidas en un archivo. Algunas operaciones conmutan el modo edición automáticamente.↩︎ El resultado será válido para cada municipio, aunque no para la provincia que tiene dos posiciones, cuyos datos no necesitamos.↩︎ Por ejemplo, en este caso sí se guardan los campos procedentes de la operación de unión, pero no se ha tenido en cuenta la selección de campos que hicimos ni la reordenación de estos.↩︎ "],["añadir-elementos-a-la-representación-las-de-capas.html", "7 Añadir elementos a la representación las de capas 7.1 Mostrar etiquetas 7.2 Representar información numérica", " 7 Añadir elementos a la representación las de capas 7.1 Mostrar etiquetas Si queremos etiquetar los datos que representemos mediante alguna información disponible en la capa, podemos hacerlo en el apartado Etiquetas de la ventana Layer properties de la capa: se puede definir qué campo mostrar en el campo Valor, generalmente se usa el campo que contenga el nombre de los elementos. Las posibilidades de presentación son muy numerosas. Es posible que las tildes de los nombres no se muestren adecuadamente. Este problema generalmente se debe a que no está leyendo los datos con la codificación adecuada. Hay muchas codificaciones posibles pero, generalmente, el problema se debe a que la capa tiene codificación UTF-8 y se ha considerado que tiene la del sistema (System) o viceversa. Si ocurre esto, podemos cambiar la codificación en el apartado Fuente de la misma ventana. 7.2 Representar información numérica Podemos etiquetar los elementos con campos de texto o numéricos. En el caso de datos numéricos, una forma alternativa de representar este tipo de información es mediante colores, generando un mapa de coropletas (también llamado mapa coropleto o coroplético), generalmente asociados a capas que representan polígonos. Figura 7.1: Definición de la simbología para representar un capa. Para definir esta forma de representación, accedemos al apartado Simbología de la ventana Layer properties de la capa (figura 7.1). En lugar de Símbolo único seleccionamos Graduado en el primer campo de la ventana; en el campo valor, seleccionamos la columna a representar que ha de ser forzosamente de tipo numérico. De entre todas las posibilidades que ofrece, las fundamentales son elegir la rampa de color a utilizar y, en el campo Modo, el método de definición de intervalos junto con el número de clases en el campo Clases. Dependiendo del orden en que definamos los campos, es posible que debamos pulsar sobre el botón Clasificar para que realice la clasificación de los valores. Si hacemos cambios, mediante el botón Borrar todo se elimina la clasificación anterior (la nueva clasifación se añadiría pulsando sobre Clasificar). Si hemos definido previamente un nivel de transparencia para representar la capa mediante Símbolo único, podemos cambiarlo desde el apartado Representación de capas. Figura 7.2: Histograma para la definición de la simbología de un capa. Adicionalmente, si seleccionamos la pestaña Histograma y pulsamos sobre el botón Cargar valores, nos muestra una representación de los valores de la variable seleccionada que puede ayudarnos a definir los intervalos (figura 7.2). Una vez pulsamos sobre el botón Aceptar para llevar a acabo la operación, el mapa se colorea según la rampa de colores seleccionada y la leyenda asociada se muestra en la ventana Capas, pulsando sobre la flecha a la izquierda del nombre de la capa. "],["generar-la-salida-del-proyecto.html", "8 Generar la salida del proyecto 8.1 Guardar como una imagen o PDF 8.2 Imprimir un mapa 8.3 Generar un mapa para la Web", " 8 Generar la salida del proyecto En este apartado vamos a generar salidas para nuestro proyecto en varios formatos. 8.1 Guardar como una imagen o PDF La manera más inmediata de generar los resultados de nuestro proyecto es guardarlo como un archivo de imagen o en formato pdf, pulsando sobre Proyecto &gt; Importar/Exportar &gt; Exportar mapa a imagen… o bien Exportar mapa a PDF…: genera una imagen o un archivo PDF a partir de lo que se muestra en el área de visualización. 8.2 Imprimir un mapa Figura 8.1: Acceso a composición de impresión en la barra de herramientas. QGIS incluye una herramienta de diseño de mapas, accesible pulsando sobre Proyecto &gt; Nueva composición de impresión… o bien desde la barra de herramientas (figura 8.1). Figura 8.2: Pantalla de la herramienta de composición de impresión. Esta herramienta, que se muestra en la figura 8.2, nos permite definir los componentes adicionales de un mapa (escala, título, leyenda, etc.), partiendo de la imagen generada en el área de visualización. Para añadir la imagen del área de visualización, pulsamos sobre Añadir mapa en la columna de la izquierda y, a continuación, pulsando-arrastrando-soltando, trazamos sobre la superficie de trabajo el rectángulo donde se situará el mapa. Usando la misma barra de herramientas de la izquierda añadimos: título (Añadir Etiqueta), escala (Añadir Barra de escala), leyenda (Añadir Leyenda), flecha del norte (Añadir Flecha del Norte). Las propiedades de cada elemento añadido se pueden definir en la ventana situada en la parte derecha, seleccionando la pestaña Propiedades del elemento (en la parte inferior). Figura 8.3: Configuración de la leyenda del mapa. Uno de los elementos a configurar es la leyenda. A partir de las capas definidas se genera automáticamente pero, demarcando el campo Auto actualizar (figura 8.3) permite editar los elementos incluidos. En cuanto a la escala, podemos configurar su formato. En caso de definirla de forma numérica, si queremos fijar un número “redondo” (p.e., 1:1500000) que es una práctica habitual si vamos a imprimir el mapa, una vez definida con este formato (estilo Numérico), seleccionamos el mapa y podemos fijar el valor del número (p.e., 1500000) en el apartado Propiedades principales del elemento. Cuando hayamos acabado la definición, podemos exportarlo como PDF pulsando sobre Diseño &gt; Exportar como PDF…. Cuando cerramos la herramienta de composición, desde QGIS podemos acceder a las composiciones previamente diseñadas pulsando sobre Proyecto &gt; Administrador de composiciones…. 8.3 Generar un mapa para la Web Si queremos generar un mapa para la Web a partir del proyecto actual, podemos usar el complemento qgis2web. Figura 8.4: Acceso al complemento qgis2web. Una vez instalado, accedemos a él desde la opción Web &gt; qgis2web &gt; Create Web map (figura 8.4). Figura 8.5: Ventana de qgis2web. En la ventana que se abre (figura 8.5), seleccionamos las capas que queremos que se muestren. Pulsando sobre el botón Update preview podemos ver el resultado que obtenemos según la selección realizada. Si pulsamos sobre el botón Export, se realiza la generación de los archivos necesarios usando la librería indicada (OpenLayers, Leaflet o Mapbox GL JS) y el resultado se puede ver de forma inmediata en el navegador11. Genera los archivos necesarios para incluir directamente el resultado en nuestra aplicación Web. Se puede configurar la ubicación de estos archivos desde la pestaña Export. Si no se abre directamente, basta con abrir con el navegador el archivo index.html, situado en la carpeta que hemos indicado para que se guarde el resultado.↩︎ "],["ejercicios.html", "Ejercicios", " Ejercicios Realiza los ejercicios y entrega un solo documento en formato PDF en la tarea correspondiente de PRADO. Ejercicio. Datos de Granada Descarga de https://doi.org/10.6084/m9.figshare.11295644: El archivo Granada.zip que contiene los archivos de las capas que se usarán como fuente de datos en formato Shapefile. El archivo actualiza censo GR 202X.zip que contiene las actualizaciones del censo de los municipios de Granada disponibles en el año 202X en dos formatos, CSV y Excel. Extrae todos archivos y sitúalos en una carpeta de trabajo. No es necesario documentar la realización de este apartado. Ejercicio 1. Representación inicial Representa las capas de la provincia de Granada facilitadas junto a una capa obtenida de la Web (distinta a la utilizada en esta actividad). Define colores adecuados para los elementos representados en las capas. Define un nivel de transparencia en la capa de municipios. Guarda el proyecto de manera que tu usuario de correo electrónico de tu cuenta de la Universidad forme parte del nombre del archivo. Para documentar la realización del ejercicio, captura una pantalla completa de QGIS donde se muestre la lista de capas representadas y el resultado obtenido (por ejemplo, las figuras 3.3, 4.3 y 4.11 son capturas de pantallas completas de QGIS). Ejercicio 2. Actualizar datos del censo Para la capa de municipios, actualiza la tabla de atributos con los datos del censo para los últimos años disponibles (los posteriores a 2018). Una vez actualizada la tabla de atributos, define un campo llamado tpc_inc_202X (sustituyendo ‘X’ por el dígito correspondiente al último año del que hay datos) como el porcentaje de incremento de población en el último año respecto al año anterior. Define un filtro que seleccione los municipios que hayan disminuido su población en el último año. Guarda la capa con todas las filas como un GeoPackage cuyo nombre incluya tu nombre de usuario de correo. Guarda la capa filtrada como un Shapefile cuyo nombre incluya tu nombre de usuario de correo y la palabra “filtro”. Para documentar la realización del ejercicio, captura una pantalla completa de la tabla de atributos de cada una de las capas guardadas donde se vean los nuevos campos añadidos. Ejercicio 3. Etiquetas y simbología Para la capa de municipios, una vez actualizada con los datos del censo: Representa el mapa mediante coropletas basadas en el campo definido en el ejercicio anterior para todos los municipios de la provincia. Define etiquetas para alguna de las capas. Para documentar la realización del ejercicio, captura una pantalla completa de QGIS donde se muestre el resultado, junto con la leyenda de colores en la ventana Capas. Ejercicio 4. Resultado del proyecto Genera una composición de impresión cuyo nombre sea tu nombre de usuario de correo, basada en el proyecto, que incluya el mapa de coropletas del ejercicio anterior, título, escala (que sea un número “redondo”), leyenda y flecha del norte. Genera un mapa para la Web a partir del proyecto. Para documentar la realización del ejercicio, captura una pantalla completa de la herramienta de composición de impresión y otra del mapa para la Web generado. "],["referencias.html", "Referencias", " Referencias Graser, Anita. 2016. Learning QGIS. 3rd ed. Packt Publishing. IDE, Andalucía. 2017. Infraestructura de Datos Espaciales de Andalucía. Junta de Andalucía, http://www.ideandalucia.es. INE. 2019. INEbase / Nomenclátor: Población Del Padrón Continuo Por Unidad Poblacional. Instituto Nacional de Estadística, http://www.ine.es/nomen2/index.do. MIT GIS, Services Group. 2016. RES.STR-001 Geographic Information System (GIS) Tutorial. January IAP 2016. Massachusetts Institute of Technology: MIT OpenCourseWare, https://ocw.mit.edu. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
