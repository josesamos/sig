<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Transformaciones básicas con R | Transformar e Integrar Información Geográfica</title>
  <meta name="description" content="<p>Sistemas de Información Geográfica.
Dpto. de Lenguajes y Sistemas Informáticos
Universidad de Granada</p>" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Transformaciones básicas con R | Transformar e Integrar Información Geográfica" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>Sistemas de Información Geográfica.
Dpto. de Lenguajes y Sistemas Informáticos
Universidad de Granada</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Transformaciones básicas con R | Transformar e Integrar Información Geográfica" />
  
  <meta name="twitter:description" content="<p>Sistemas de Información Geográfica.
Dpto. de Lenguajes y Sistemas Informáticos
Universidad de Granada</p>" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="datos-de-partida-y-transformaciones-a-realizar.html"/>
<link rel="next" href="transformaciones-básicas-con-qgis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SIG</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="datos-de-partida-y-transformaciones-a-realizar.html"><a href="datos-de-partida-y-transformaciones-a-realizar.html"><i class="fa fa-check"></i><b>2</b> Datos de partida y transformaciones a realizar</a>
<ul>
<li class="chapter" data-level="2.1" data-path="datos-de-partida-y-transformaciones-a-realizar.html"><a href="datos-de-partida-y-transformaciones-a-realizar.html#datos-partida"><i class="fa fa-check"></i><b>2.1</b> Datos de partida</a></li>
<li class="chapter" data-level="2.2" data-path="datos-de-partida-y-transformaciones-a-realizar.html"><a href="datos-de-partida-y-transformaciones-a-realizar.html#transformaciones"><i class="fa fa-check"></i><b>2.2</b> Transformaciones a realizar</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html"><i class="fa fa-check"></i><b>3</b> Transformaciones básicas con <em>R</em></a>
<ul>
<li class="chapter" data-level="3.1" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#leer-una-capa"><i class="fa fa-check"></i><b>3.1</b> Leer una capa</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#leer-una-capa-vectorial"><i class="fa fa-check"></i><b>3.1.1</b> Leer una capa vectorial</a></li>
<li class="chapter" data-level="3.1.2" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#leer-una-capa-ráster"><i class="fa fa-check"></i><b>3.1.2</b> Leer una capa ráster</a></li>
<li class="chapter" data-level="3.1.3" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#componer-un-ráster-virtual-a-partir-de-varios-ráster"><i class="fa fa-check"></i><b>3.1.3</b> Componer un ráster virtual a partir de varios ráster</a></li>
<li class="chapter" data-level="3.1.4" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#obtener-un-ráster-multibanda-a-partir-de-varias-bandas"><i class="fa fa-check"></i><b>3.1.4</b> Obtener un ráster multibanda a partir de varias bandas</a></li>
<li class="chapter" data-level="3.1.5" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#obtener-un-ráster-con-las-bandas-de-satélite"><i class="fa fa-check"></i><b>3.1.5</b> Obtener un ráster con las bandas de satélite</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#reproyectar-una-capa"><i class="fa fa-check"></i><b>3.2</b> Reproyectar una capa</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#reproyectar-una-capa-vectorial"><i class="fa fa-check"></i><b>3.2.1</b> Reproyectar una capa vectorial</a></li>
<li class="chapter" data-level="3.2.2" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#reproyectar-una-capa-ráster"><i class="fa fa-check"></i><b>3.2.2</b> Reproyectar una capa ráster</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#guardar-una-capa"><i class="fa fa-check"></i><b>3.3</b> Guardar una capa</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#transformar-e-integrar-guardar-capa-vectorial"><i class="fa fa-check"></i><b>3.3.1</b> Guardar una capa vectorial</a></li>
<li class="chapter" data-level="3.3.2" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#guardar-una-capa-ráster"><i class="fa fa-check"></i><b>3.3.2</b> Guardar una capa ráster</a></li>
<li class="chapter" data-level="3.3.3" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#guardar-las-bandas-de-satélite"><i class="fa fa-check"></i><b>3.3.3</b> Guardar las bandas de satélite</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#recortar-una-capa"><i class="fa fa-check"></i><b>3.4</b> Recortar una capa</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#recortar-una-capa-vectorial"><i class="fa fa-check"></i><b>3.4.1</b> Recortar una capa vectorial</a></li>
<li class="chapter" data-level="3.4.2" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#recortar-una-capa-ráster"><i class="fa fa-check"></i><b>3.4.2</b> Recortar una capa ráster</a></li>
<li class="chapter" data-level="3.4.3" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#recortar-las-bandas-de-satélite"><i class="fa fa-check"></i><b>3.4.3</b> Recortar las bandas de satélite</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#tratar-los-archivos-de-una-o-varias-carpetas"><i class="fa fa-check"></i><b>3.5</b> Tratar los archivos de una o varias carpetas</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#obtener-y-tratar-los-archivos-de-una-carpeta"><i class="fa fa-check"></i><b>3.5.1</b> Obtener y tratar los archivos de una carpeta</a></li>
<li class="chapter" data-level="3.5.2" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#obtener-y-tratar-los-archivos-de-varias-carpetas"><i class="fa fa-check"></i><b>3.5.2</b> Obtener y tratar los archivos de varias carpetas</a></li>
<li class="chapter" data-level="3.5.3" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#descomprimir-todos-los-archivos-de-una-carpeta"><i class="fa fa-check"></i><b>3.5.3</b> Descomprimir todos los archivos de una carpeta</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#otras-operaciones"><i class="fa fa-check"></i><b>3.6</b> Otras operaciones</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="transformaciones-básicas-con-r.html"><a href="transformaciones-básicas-con-r.html#copiar-estilos-entre-archivos-geopackage"><i class="fa fa-check"></i><b>3.6.1</b> Copiar estilos entre archivos <em>GeoPackage</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html"><i class="fa fa-check"></i><b>4</b> Transformaciones básicas con <em>QGIS</em></a>
<ul>
<li class="chapter" data-level="4.1" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html#codificación-de-los-caracteres-en-una-capa"><i class="fa fa-check"></i><b>4.1</b> Codificación de los caracteres en una capa</a></li>
<li class="chapter" data-level="4.2" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html#reproyectar-una-capa-1"><i class="fa fa-check"></i><b>4.2</b> Reproyectar una capa</a></li>
<li class="chapter" data-level="4.3" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html#componer-un-ráster-virtual-a-partir-de-varios-ráster-1"><i class="fa fa-check"></i><b>4.3</b> Componer un ráster virtual a partir de varios ráster</a></li>
<li class="chapter" data-level="4.4" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html#recortar-una-capa-ráster-1"><i class="fa fa-check"></i><b>4.4</b> Recortar una capa ráster</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html#mediante-un-rectángulo-2"><i class="fa fa-check"></i><b>4.4.1</b> Mediante un rectángulo</a></li>
<li class="chapter" data-level="4.4.2" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html#mediante-cualquier-polígono-2"><i class="fa fa-check"></i><b>4.4.2</b> Mediante cualquier polígono</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html#recortar-una-capa-vectorial-1"><i class="fa fa-check"></i><b>4.5</b> Recortar una capa vectorial</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html#recortar-cualquier-capa-vectorial"><i class="fa fa-check"></i><b>4.5.1</b> Recortar cualquier capa vectorial</a></li>
<li class="chapter" data-level="4.5.2" data-path="transformaciones-básicas-con-qgis.html"><a href="transformaciones-básicas-con-qgis.html#copiar-y-pegar-el-estilo-de-una-capa-vectorial"><i class="fa fa-check"></i><b>4.5.2</b> Copiar y pegar el estilo de una capa vectorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i>Ejercicios</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Transformar e Integrar Información Geográfica</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="transformaciones-básicas-con-r" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Transformaciones básicas con <em>R</em><a href="transformaciones-básicas-con-r.html#transformaciones-básicas-con-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A continuación se presentan las operaciones de transformación básicas que podemos realizar sobre las capas con <em>R</em>. Para trabajar con las capas vectoriales utilizaremos el paquete <code>sf</code>, para las capas ráster usaremos los paquetes <code>terra</code> y <a href="https://cran.r-project.org/package=satres"><code>satres</code></a>. En ambos casos también podremos usar las funciones del paquete <a href="https://github.com/josesamos/sigugr"><code>sigugr</code></a><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<div id="leer-una-capa" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Leer una capa<a href="transformaciones-básicas-con-r.html#leer-una-capa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="leer-una-capa-vectorial" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Leer una capa vectorial<a href="transformaciones-básicas-con-r.html#leer-una-capa-vectorial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cuando leamos una capa vectorial, para comprobar que la codificación de los caracteres es la adecuada, tenemos que comprobar que las palabras con tilde se vean correctamente. Por defecto, la función <code>st_read()</code> lee los datos en <code>UTF-8</code>. Si no se leen correctamente deberemos cambiar la codificación, generalmente a <code>WINDOWS-1252</code>, como se muestra en el ejemplo siguiente.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="transformaciones-básicas-con-r.html#cb1-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;cnig/cuadriculas/MTN25_ETRS89_Peninsula_Baleares_Canarias.shp&quot;</span></span>
<span id="cb1-2"><a href="transformaciones-básicas-con-r.html#cb1-2" tabindex="-1"></a>cuadricula25 <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(file, <span class="at">options =</span> <span class="st">&quot;ENCODING=WINDOWS-1252&quot;</span>)</span></code></pre></div>
<p>Al leer un formato de archivo que pueda contener varias capas, podemos consultar las capas disponibles mediante la función siguiente:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="transformaciones-básicas-con-r.html#cb2-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;lanjaron-jsamos.gpkg&quot;</span></span>
<span id="cb2-2"><a href="transformaciones-básicas-con-r.html#cb2-2" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_layers</span>(file)</span></code></pre></div>
<p>Adicionalmente, al leer un formato de archivo que pueda contener varias capas, podemos indicar la capa que queremos obtener.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="transformaciones-básicas-con-r.html#cb3-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;lanjaron-jsamos.gpkg&quot;</span></span>
<span id="cb3-2"><a href="transformaciones-básicas-con-r.html#cb3-2" tabindex="-1"></a>layer <span class="ot">&lt;-</span> <span class="st">&quot;lanjaron-jsamos&quot;</span></span>
<span id="cb3-3"><a href="transformaciones-básicas-con-r.html#cb3-3" tabindex="-1"></a>lanjaron_jsamos <span class="ot">&lt;-</span></span>
<span id="cb3-4"><a href="transformaciones-básicas-con-r.html#cb3-4" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_read</span>(file, <span class="at">layer =</span> layer)</span></code></pre></div>
<p>Podemos representar la geometría de la capa leída mediante las funciones siguientes:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="transformaciones-básicas-con-r.html#cb4-1" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(sf<span class="sc">::</span><span class="fu">st_geometry</span>(lanjaron_jsamos))</span></code></pre></div>
</div>
<div id="leer-una-capa-ráster" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Leer una capa ráster<a href="transformaciones-básicas-con-r.html#leer-una-capa-ráster" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se pueden leer todas las bandas de un ráster conjuntamente mediante la función <code>rast()</code> del paquete <code>terra</code>. Las presentamos combinándolas con la función <code>plotRGB()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="transformaciones-básicas-con-r.html#cb5-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;linea/ortofoto/102643_ortofoto2016_50cm.jp2&quot;</span></span>
<span id="cb5-2"><a href="transformaciones-básicas-con-r.html#cb5-2" tabindex="-1"></a>ortofoto <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(file)</span>
<span id="cb5-3"><a href="transformaciones-básicas-con-r.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="transformaciones-básicas-con-r.html#cb5-4" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plotRGB</span>(ortofoto)</span></code></pre></div>
</div>
<div id="componer-un-ráster-virtual-a-partir-de-varios-ráster" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Componer un ráster virtual a partir de varios ráster<a href="transformaciones-básicas-con-r.html#componer-un-ráster-virtual-a-partir-de-varios-ráster" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si hemos obtenido varias capas ráster que, conjuntamente, cubren nuestra zona de trabajo, podemos definir un ráster virtual mediante la función <code>vrt()</code>, a partir de un vector de archivos que podemos obtener directamente leyendo el contenido de una carpeta, como se muestra a continuación.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="transformaciones-básicas-con-r.html#cb6-1" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">&quot;cnig/mdt05/&quot;</span></span>
<span id="cb6-2"><a href="transformaciones-básicas-con-r.html#cb6-2" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> folder, <span class="at">pattern =</span> <span class="st">&quot;*.tif&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-3"><a href="transformaciones-básicas-con-r.html#cb6-3" tabindex="-1"></a>mdt05 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">vrt</span>(files, <span class="at">filename=</span> <span class="st">&quot;tmp/mdt05.vrt&quot;</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-4"><a href="transformaciones-básicas-con-r.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="transformaciones-básicas-con-r.html#cb6-5" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(mdt05)</span></code></pre></div>
<p>Como resultado, crea el archivo que se indica en el parámetro <code>filename</code>, correspondiente al ráster virtual, que podemos tratar como cualquier otro ráster. Es un archivo de pequeño tamaño porque se limita a referenciar al resto de capas que lo componen.</p>
<p>Esta función es adecuada tanto para capas de una sola banda como para capas multibanda.</p>
<p>También podemos usar directamente la función definida en el paquete de la asignatura a partir de la anterior.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="transformaciones-básicas-con-r.html#cb7-1" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">&quot;cnig/mdt05/&quot;</span></span>
<span id="cb7-2"><a href="transformaciones-básicas-con-r.html#cb7-2" tabindex="-1"></a>mdt05 <span class="ot">&lt;-</span> sigugr<span class="sc">::</span><span class="fu">compose_raster</span>(folder)</span>
<span id="cb7-3"><a href="transformaciones-básicas-con-r.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="transformaciones-básicas-con-r.html#cb7-4" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(mdt05)</span></code></pre></div>
</div>
<div id="obtener-un-ráster-multibanda-a-partir-de-varias-bandas" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Obtener un ráster multibanda a partir de varias bandas<a href="transformaciones-básicas-con-r.html#obtener-un-ráster-multibanda-a-partir-de-varias-bandas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si tenemos las bandas almacenadas en archivos distintos (como ocurre con el caso de las bandas obtenidas al descargar los datos de los satélites), para obtener un ráster multibanda, debemos leerlas independientemente y generar a partir de ellas la nueva estructura.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="transformaciones-básicas-con-r.html#cb8-1" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">&quot;esa/IMG_DATA_01/R10m/&quot;</span></span>
<span id="cb8-2"><a href="transformaciones-básicas-con-r.html#cb8-2" tabindex="-1"></a>file1 <span class="ot">&lt;-</span> <span class="st">&quot;T30SVF_20230905T105621_B02_10m.jp2&quot;</span></span>
<span id="cb8-3"><a href="transformaciones-básicas-con-r.html#cb8-3" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="fu">paste0</span>(folder, file1))</span>
<span id="cb8-4"><a href="transformaciones-básicas-con-r.html#cb8-4" tabindex="-1"></a>file2 <span class="ot">&lt;-</span> <span class="st">&quot;T30SVF_20230905T105621_B03_10m.jp2&quot;</span></span>
<span id="cb8-5"><a href="transformaciones-básicas-con-r.html#cb8-5" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="fu">paste0</span>(folder, file2))</span>
<span id="cb8-6"><a href="transformaciones-básicas-con-r.html#cb8-6" tabindex="-1"></a>file3 <span class="ot">&lt;-</span> <span class="st">&quot;T30SVF_20230905T105621_B04_10m.jp2&quot;</span></span>
<span id="cb8-7"><a href="transformaciones-básicas-con-r.html#cb8-7" tabindex="-1"></a>b4 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="fu">paste0</span>(folder, file3))</span>
<span id="cb8-8"><a href="transformaciones-básicas-con-r.html#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="transformaciones-básicas-con-r.html#cb8-9" tabindex="-1"></a>bands <span class="ot">&lt;-</span> <span class="fu">c</span>(b4, b3, b2)</span>
<span id="cb8-10"><a href="transformaciones-básicas-con-r.html#cb8-10" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plotRGB</span>(bands, <span class="at">stretch =</span> <span class="st">&#39;lin&#39;</span>)</span></code></pre></div>
<p>El ráster multibanda se genera al definir un vector de variables ráster. En este caso, se han definido en el orden adecuado para que la función <code>plotRGB()</code> presente una fotografía en color.</p>
</div>
<div id="obtener-un-ráster-con-las-bandas-de-satélite" class="section level3 hasAnchor" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> Obtener un ráster con las bandas de satélite<a href="transformaciones-básicas-con-r.html#obtener-un-ráster-con-las-bandas-de-satélite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para obtener un ráster a partir de las bandas de satélite, podemos usar el paquete <code>satres</code> que, utilizando las funciones descritas en los apartados anteriores, a partir de la carpeta que almacena los archivos ráster (independientemente de su anidamiento), genera una estructura con todas las bandas obtenidas de satélite, clasificadas por su resolución espacial, generando estructuras de ráster virtual si es necesario.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="transformaciones-básicas-con-r.html#cb9-1" tabindex="-1"></a>esa <span class="ot">&lt;-</span> satres<span class="sc">::</span><span class="fu">satres</span>(<span class="st">&quot;esa&quot;</span>)</span></code></pre></div>
<p>A partir de la estructura generada, seleccionando la resolución espacial, podemos obtener objetos de la clase <code>SpatRaster</code> (definida en el paquete <code>terra</code>), y trabajar normalmente con ellos.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="transformaciones-básicas-con-r.html#cb10-1" tabindex="-1"></a>esa <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="transformaciones-básicas-con-r.html#cb10-2" tabindex="-1"></a>  satres<span class="sc">::</span><span class="fu">get_spatial_resolution</span>()</span>
<span id="cb10-3"><a href="transformaciones-básicas-con-r.html#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="transformaciones-básicas-con-r.html#cb10-4" tabindex="-1"></a>r10m <span class="ot">&lt;-</span> esa <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="transformaciones-básicas-con-r.html#cb10-5" tabindex="-1"></a>  satres<span class="sc">::</span><span class="fu">as_SpatRaster</span>(<span class="st">&quot;r10m&quot;</span>)</span>
<span id="cb10-6"><a href="transformaciones-básicas-con-r.html#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="transformaciones-básicas-con-r.html#cb10-7" tabindex="-1"></a>bands <span class="ot">&lt;-</span> <span class="fu">c</span>(r10m[[<span class="st">&#39;B04&#39;</span>]], r10m[[<span class="st">&#39;B03&#39;</span>]], r10m[[<span class="st">&#39;B02&#39;</span>]])</span>
<span id="cb10-8"><a href="transformaciones-básicas-con-r.html#cb10-8" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plotRGB</span>(bands, <span class="at">stretch =</span> <span class="st">&#39;lin&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="reproyectar-una-capa" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Reproyectar una capa<a href="transformaciones-básicas-con-r.html#reproyectar-una-capa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="reproyectar-una-capa-vectorial" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Reproyectar una capa vectorial<a href="transformaciones-básicas-con-r.html#reproyectar-una-capa-vectorial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Proyectaremos una capa vectorial mediante la función <code>st_transform()</code>. En el parámetro <code>crs</code> se puede indicar directamente el código EPSG de la capa o bien el CRS obtenido a partir de otra capa mediante las funciones que lo devuelven.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="transformaciones-básicas-con-r.html#cb11-1" tabindex="-1"></a>lanjaron_jsamos_c25 <span class="ot">&lt;-</span></span>
<span id="cb11-2"><a href="transformaciones-básicas-con-r.html#cb11-2" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(lanjaron_jsamos, <span class="at">crs =</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(cuadricula25))</span></code></pre></div>
<p>La función utilizada para obtener el CRS es adecuada para una capa vectorial y también para una ráster. En ambos casos también podemos usar la función <code>terra::crs()</code>.</p>
</div>
<div id="reproyectar-una-capa-ráster" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Reproyectar una capa ráster<a href="transformaciones-básicas-con-r.html#reproyectar-una-capa-ráster" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un ráster se puede reproyectar mediante la función <code>project()</code> del paquete <code>terra</code>. Hay que tener presente que la operación suele ser bastante costosa en tiempo de ejecución y es posible que se pierda información ya que la correspondencia entre las celdas del ráster inicial y del resultado puede no ser directa.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="transformaciones-básicas-con-r.html#cb12-1" tabindex="-1"></a>ortofoto_lan_sat <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="transformaciones-básicas-con-r.html#cb12-2" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">project</span>(ortofoto, terra<span class="sc">::</span><span class="fu">crs</span>(lanjaron_jsamos_sat))</span></code></pre></div>
<p>Por eso, según la operación que vayamos a hacer, debemos valorar podemos trabajar con el CRS del ráster y reproyectar las capas vectoriales.</p>
</div>
</div>
<div id="guardar-una-capa" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Guardar una capa<a href="transformaciones-básicas-con-r.html#guardar-una-capa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="transformar-e-integrar-guardar-capa-vectorial" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Guardar una capa vectorial<a href="transformaciones-básicas-con-r.html#transformar-e-integrar-guardar-capa-vectorial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para guardar una capa vectorial, indicamos la variable con la capa, el nombre del archivo (el formato se toma de este nombre) y el nombre que le queremos dar a la capa. También podemos indicar si queremos que se borre el archivo si ya existe, mediante el parámetro <code>delete_dsn</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="transformaciones-básicas-con-r.html#cb13-1" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron_jsamos,</span>
<span id="cb13-2"><a href="transformaciones-básicas-con-r.html#cb13-2" tabindex="-1"></a>             <span class="at">dsn =</span> <span class="st">&quot;tmp/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb13-3"><a href="transformaciones-básicas-con-r.html#cb13-3" tabindex="-1"></a>             <span class="at">layer =</span> <span class="st">&quot;lanjaron-jsamos&quot;</span>,</span>
<span id="cb13-4"><a href="transformaciones-básicas-con-r.html#cb13-4" tabindex="-1"></a>             <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-5"><a href="transformaciones-básicas-con-r.html#cb13-5" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron_jsamos_sat,</span>
<span id="cb13-6"><a href="transformaciones-básicas-con-r.html#cb13-6" tabindex="-1"></a>             <span class="at">dsn =</span> <span class="st">&quot;tmp/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb13-7"><a href="transformaciones-básicas-con-r.html#cb13-7" tabindex="-1"></a>             <span class="at">layer =</span> <span class="st">&quot;lanjaron_jsamos_sat&quot;</span>)</span></code></pre></div>
</div>
<div id="guardar-una-capa-ráster" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Guardar una capa ráster<a href="transformaciones-básicas-con-r.html#guardar-una-capa-ráster" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Independientemente del número de bandas de ráster y de la estructura de datos de este, lo podemos guardar en un archivo mediante la función <code>writeRaster()</code>. Mediante el parámetro <code>filetype</code> se indica el tipo de los datos de las bandas del ráster, aunque para el formato <em>tif</em> la opción por defecto de este parámetro es adecuada.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="transformaciones-básicas-con-r.html#cb14-1" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(ortofoto,</span>
<span id="cb14-2"><a href="transformaciones-básicas-con-r.html#cb14-2" tabindex="-1"></a>                   <span class="st">&quot;tmp/ortofoto.tif&quot;</span>,</span>
<span id="cb14-3"><a href="transformaciones-básicas-con-r.html#cb14-3" tabindex="-1"></a>                   <span class="at">filetype =</span> <span class="st">&quot;GTiff&quot;</span>,</span>
<span id="cb14-4"><a href="transformaciones-básicas-con-r.html#cb14-4" tabindex="-1"></a>                   <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-5"><a href="transformaciones-básicas-con-r.html#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="transformaciones-básicas-con-r.html#cb14-6" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(ortofoto,</span>
<span id="cb14-7"><a href="transformaciones-básicas-con-r.html#cb14-7" tabindex="-1"></a>                   <span class="st">&quot;tmp/ortofoto2.tif&quot;</span>,</span>
<span id="cb14-8"><a href="transformaciones-básicas-con-r.html#cb14-8" tabindex="-1"></a>                   <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="guardar-las-bandas-de-satélite" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Guardar las bandas de satélite<a href="transformaciones-básicas-con-r.html#guardar-las-bandas-de-satélite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si hemos creado un objeto <code>satres</code> a partir de las bandas de satélite, podemos guardarlas en archivos según su resolución espacial.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="transformaciones-básicas-con-r.html#cb15-1" tabindex="-1"></a>esa <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="transformaciones-básicas-con-r.html#cb15-2" tabindex="-1"></a>  satres<span class="sc">::</span><span class="fu">save_by_resolution</span>(<span class="at">out_dir =</span> <span class="st">&quot;tmp/esa&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="recortar-una-capa" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Recortar una capa<a href="transformaciones-básicas-con-r.html#recortar-una-capa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="recortar-una-capa-vectorial" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Recortar una capa vectorial<a href="transformaciones-básicas-con-r.html#recortar-una-capa-vectorial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>He podido recortar todas las capas vectoriales sin ningún problema mediante las funciones que se indican a continuación. En el caso de <em>CORINE Land Cover</em> del año 2018, al recortar de cualquier forma, producía un error relacionado con el tipo de datos (<code>ParseException: Unknown WKB type 12</code>). Está solucionado mediante la función <code>sigugr::clip_multipoligon()</code>.</p>
<div id="mediante-un-rectángulo" class="section level4 hasAnchor" number="3.4.1.1">
<h4><span class="header-section-number">3.4.1.1</span> Mediante un rectángulo<a href="transformaciones-básicas-con-r.html#mediante-un-rectángulo" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La función <code>st_crop()</code> recorta una capa vectorial mediante el mínimo rectángulo envolvente orientado de Norte a Sur de la capa vectorial que se indica.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="transformaciones-básicas-con-r.html#cb16-1" tabindex="-1"></a>clc <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_crop</span>(clc, lanjaron_jsamos)</span></code></pre></div>
</div>
<div id="mediante-cualquier-polígono" class="section level4 hasAnchor" number="3.4.1.2">
<h4><span class="header-section-number">3.4.1.2</span> Mediante cualquier polígono<a href="transformaciones-básicas-con-r.html#mediante-cualquier-polígono" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La función <code>st_intersection()</code> obtiene la intersección de las capas vectoriales que se indican.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="transformaciones-básicas-con-r.html#cb17-1" tabindex="-1"></a>clc <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_intersection</span>(clc, lanjaron_jsamos)</span></code></pre></div>
<p>En el ejemplo se usa el resultado de recortar una capa mediante la función <code>st_crop()</code> ya que contiene al polígono que usamos en la función <code>st_intersection()</code>.</p>
<p>También podemos usar la función siguiente con la misma finalidad.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="transformaciones-básicas-con-r.html#cb18-1" tabindex="-1"></a>clc <span class="ot">&lt;-</span> sigugr<span class="sc">::</span><span class="fu">clip_vector</span>(clc, lanjaron_jsamos)</span></code></pre></div>
</div>
</div>
<div id="recortar-una-capa-ráster" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Recortar una capa ráster<a href="transformaciones-básicas-con-r.html#recortar-una-capa-ráster" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="mediante-un-rectángulo-1" class="section level4 hasAnchor" number="3.4.2.1">
<h4><span class="header-section-number">3.4.2.1</span> Mediante un rectángulo<a href="transformaciones-básicas-con-r.html#mediante-un-rectángulo-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La función <code>crop()</code> recorta una capa ráster mediante el mínimo rectángulo envolvente orientado de Norte a Sur de la capa vectorial que se indica.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="transformaciones-básicas-con-r.html#cb19-1" tabindex="-1"></a>rb1 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">crop</span>(rb, lanjaron_jsamos)</span></code></pre></div>
</div>
<div id="mediante-cualquier-polígono-1" class="section level4 hasAnchor" number="3.4.2.2">
<h4><span class="header-section-number">3.4.2.2</span> Mediante cualquier polígono<a href="transformaciones-básicas-con-r.html#mediante-cualquier-polígono-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La función <code>mask()</code> recorta una capa ráster mediante el polígono de la capa vectorial que se indica.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="transformaciones-básicas-con-r.html#cb20-1" tabindex="-1"></a>rb2 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">mask</span>(rb1, lanjaron_jsamos)</span></code></pre></div>
<p>En el ejemplo se usa el resultado de recortar una capa mediante la función <code>crop()</code> ya que contiene al polígono que usamos en la función <code>mask()</code>.</p>
<p>También podemos usar la función siguiente con la misma finalidad, definida en el paquete de la asignatura a partir de las anteriores.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="transformaciones-básicas-con-r.html#cb21-1" tabindex="-1"></a>rb2 <span class="ot">&lt;-</span> sigugr<span class="sc">::</span><span class="fu">clip_raster</span>(rb, lanjaron_jsamos)</span></code></pre></div>
</div>
</div>
<div id="recortar-las-bandas-de-satélite" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Recortar las bandas de satélite<a href="transformaciones-básicas-con-r.html#recortar-las-bandas-de-satélite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si hemos creado un objeto <code>satres</code> a partir de las bandas de satélite, podemos recortar todas las bandas conjuntamente mediante la función <code>clip_bands()</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="transformaciones-básicas-con-r.html#cb22-1" tabindex="-1"></a>esa_lan <span class="ot">&lt;-</span> esa <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="transformaciones-básicas-con-r.html#cb22-2" tabindex="-1"></a>  satres<span class="sc">::</span><span class="fu">clip_bands</span>(lanjaron_jsamos)</span></code></pre></div>
</div>
</div>
<div id="tratar-los-archivos-de-una-o-varias-carpetas" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Tratar los archivos de una o varias carpetas<a href="transformaciones-básicas-con-r.html#tratar-los-archivos-de-una-o-varias-carpetas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para realizar la transformación en <em>R</em> podemos desarrollar código que permita tratar todos los archivos de una o varias carpetas conjuntamente. A continuación se presentan algunas de ellas.</p>
<p>Adicionalmente, para simplificar el proceso de transformación, podemos definir una función con los pasos necesarios para transformar un tipo de archivo y llamarla repetidas veces pasándole los parámetros adecuados.</p>
<div id="obtener-y-tratar-los-archivos-de-una-carpeta" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Obtener y tratar los archivos de una carpeta<a href="transformaciones-básicas-con-r.html#obtener-y-tratar-los-archivos-de-una-carpeta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mediante la función <code>list.files()</code> obtenemos los archivos contenidos en la una carpeta, del tipo indicado mediante un patrón. A continuación, podemos iterar sobre ellos para tratarlos convenientemente.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="transformaciones-básicas-con-r.html#cb23-1" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;cnig/mdt05/&quot;</span></span>
<span id="cb23-2"><a href="transformaciones-básicas-con-r.html#cb23-2" tabindex="-1"></a>lf <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> path, <span class="at">pattern =</span> <span class="st">&quot;*.tif&quot;</span>)</span>
<span id="cb23-3"><a href="transformaciones-básicas-con-r.html#cb23-3" tabindex="-1"></a><span class="cf">for</span> (f <span class="cf">in</span> lf) {</span>
<span id="cb23-4"><a href="transformaciones-básicas-con-r.html#cb23-4" tabindex="-1"></a>  <span class="fu">paste0</span>(path, f)</span>
<span id="cb23-5"><a href="transformaciones-básicas-con-r.html#cb23-5" tabindex="-1"></a>  <span class="co"># ...</span></span>
<span id="cb23-6"><a href="transformaciones-básicas-con-r.html#cb23-6" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="obtener-y-tratar-los-archivos-de-varias-carpetas" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Obtener y tratar los archivos de varias carpetas<a href="transformaciones-básicas-con-r.html#obtener-y-tratar-los-archivos-de-varias-carpetas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si necesitamos tratar los archivos de varias carpetas, podemos definir una lista de las carpetas (o de la forma cómo obtenerlas) e ir recorriéndola para tratarlas.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="transformaciones-básicas-con-r.html#cb24-1" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;usgs/&quot;</span></span>
<span id="cb24-2"><a href="transformaciones-básicas-con-r.html#cb24-2" tabindex="-1"></a>lf <span class="ot">&lt;-</span></span>
<span id="cb24-3"><a href="transformaciones-básicas-con-r.html#cb24-3" tabindex="-1"></a>  <span class="fu">list.files</span>(</span>
<span id="cb24-4"><a href="transformaciones-básicas-con-r.html#cb24-4" tabindex="-1"></a>    <span class="at">path =</span> path,</span>
<span id="cb24-5"><a href="transformaciones-básicas-con-r.html#cb24-5" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">&quot;*.tif&quot;</span>,</span>
<span id="cb24-6"><a href="transformaciones-básicas-con-r.html#cb24-6" tabindex="-1"></a>    <span class="at">recursive =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-7"><a href="transformaciones-básicas-con-r.html#cb24-7" tabindex="-1"></a>    <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb24-8"><a href="transformaciones-básicas-con-r.html#cb24-8" tabindex="-1"></a>  )</span>
<span id="cb24-9"><a href="transformaciones-básicas-con-r.html#cb24-9" tabindex="-1"></a><span class="cf">for</span> (f <span class="cf">in</span> lf) {</span>
<span id="cb24-10"><a href="transformaciones-básicas-con-r.html#cb24-10" tabindex="-1"></a>  f</span>
<span id="cb24-11"><a href="transformaciones-básicas-con-r.html#cb24-11" tabindex="-1"></a>  <span class="co"># ...</span></span>
<span id="cb24-12"><a href="transformaciones-básicas-con-r.html#cb24-12" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="descomprimir-todos-los-archivos-de-una-carpeta" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Descomprimir todos los archivos de una carpeta<a href="transformaciones-básicas-con-r.html#descomprimir-todos-los-archivos-de-una-carpeta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A veces tenemos que descargar varios archivos en formato zip o tar sobre un mismo tema para tratar su contenido conjuntamente. Podemos descomprimirlos indicando la carpeta en la que se encuentra mediante la función <code>sat_untarzip()</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="transformaciones-básicas-con-r.html#cb25-1" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;originales/cnig/mdt&quot;</span></span>
<span id="cb25-2"><a href="transformaciones-básicas-con-r.html#cb25-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> satres<span class="sc">::</span><span class="fu">sat_untarzip</span>(path, <span class="at">out_dir =</span> <span class="st">&quot;tmp/mdt&quot;</span>)</span></code></pre></div>
<p>Se puede usar en primer lugar con el parámetro <code>only_show_files = TRUE</code> para mostrar los archivos a descomprimir y las carpetas de salida.</p>
</div>
</div>
<div id="otras-operaciones" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Otras operaciones<a href="transformaciones-básicas-con-r.html#otras-operaciones" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="copiar-estilos-entre-archivos-geopackage" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Copiar estilos entre archivos <em>GeoPackage</em><a href="transformaciones-básicas-con-r.html#copiar-estilos-entre-archivos-geopackage" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Las capas vectoriales contenidas en un <em>GeoPackage</em> pueden tener asociado un estilo dentro del propio archivo. Por ejemplo, este es el caso de <strong><em>CORINE Land Cover</em></strong>: en los estilos se define la leyenda y los colores asociados a cada código.</p>
<p>Aunque recortemos y almacenemos las capas de interés en un nuevo <em>GeoPackage</em>, los estilos no se verán afectados ni tampoco se incluirán automáticamente en el nuevo archivo.</p>
<p>Una vez tengamos los dos archivos <em>GeoPackage</em> disponibles, podemos copiar los estilos de uno a otro mediante la función siguiente:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="transformaciones-básicas-con-r.html#cb26-1" tabindex="-1"></a>from <span class="ot">=</span> <span class="st">&quot;cnig/clc/CLC2018_ES.gpkg&quot;</span></span>
<span id="cb26-2"><a href="transformaciones-básicas-con-r.html#cb26-2" tabindex="-1"></a>to <span class="ot">=</span> <span class="st">&quot;tmp/clc_lanjaron_jsamos.gpkg&quot;</span></span>
<span id="cb26-3"><a href="transformaciones-básicas-con-r.html#cb26-3" tabindex="-1"></a>sigugr<span class="sc">::</span><span class="fu">copy_styles_layer</span>(from, to)</span></code></pre></div>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Disponible solo en <a href="https://github.com/"><em>GitHub</em></a>. Se instala mediante <code>devtools::install_github("josesamos/sigugr")</code><a href="transformaciones-básicas-con-r.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="datos-de-partida-y-transformaciones-a-realizar.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="transformaciones-básicas-con-qgis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
