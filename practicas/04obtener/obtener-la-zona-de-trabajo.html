<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Obtener la zona de trabajo | Obtener y Definir Información Geográfica</title>
  <meta name="description" content="<p>Sistemas de Información Geográfica.
Dpto. de Lenguajes y Sistemas Informáticos
Universidad de Granada</p>" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Obtener la zona de trabajo | Obtener y Definir Información Geográfica" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>Sistemas de Información Geográfica.
Dpto. de Lenguajes y Sistemas Informáticos
Universidad de Granada</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Obtener la zona de trabajo | Obtener y Definir Información Geográfica" />
  
  <meta name="twitter:description" content="<p>Sistemas de Información Geográfica.
Dpto. de Lenguajes y Sistemas Informáticos
Universidad de Granada</p>" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="capas-temáticas.html"/>
<link rel="next" href="ortofotografía-mdt-e-información-geográfica-temática.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SIG</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="herramientas.html"><a href="herramientas.html"><i class="fa fa-check"></i><b>2</b> Herramientas a Instalar</a>
<ul>
<li class="chapter" data-level="2.1" data-path="herramientas.html"><a href="herramientas.html#qgis-desktop"><i class="fa fa-check"></i><b>2.1</b> <em>QGIS Desktop</em></a></li>
<li class="chapter" data-level="2.2" data-path="herramientas.html"><a href="herramientas.html#r-y-rstudio"><i class="fa fa-check"></i><b>2.2</b> <em>R</em> y <em>RStudio</em></a></li>
<li class="chapter" data-level="2.3" data-path="herramientas.html"><a href="herramientas.html#postgresql-postgis-y-pgadmin"><i class="fa fa-check"></i><b>2.3</b> <em>PostgreSQL</em>, <em>PostGIS</em> y <em>PgAdmin</em></a></li>
<li class="chapter" data-level="2.4" data-path="herramientas.html"><a href="herramientas.html#geoserver"><i class="fa fa-check"></i><b>2.4</b> <em>GeoServer</em></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="capas-temáticas.html"><a href="capas-temáticas.html"><i class="fa fa-check"></i><b>3</b> Capas temáticas</a>
<ul>
<li class="chapter" data-level="3.1" data-path="capas-temáticas.html"><a href="capas-temáticas.html#dera"><i class="fa fa-check"></i><b>3.1</b> DERA</a></li>
<li class="chapter" data-level="3.2" data-path="capas-temáticas.html"><a href="capas-temáticas.html#ideandalucía"><i class="fa fa-check"></i><b>3.2</b> IDEAndalucía</a></li>
<li class="chapter" data-level="3.3" data-path="capas-temáticas.html"><a href="capas-temáticas.html#openstreetmap"><i class="fa fa-check"></i><b>3.3</b> OpenStreetMap</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="obtener-la-zona-de-trabajo.html"><a href="obtener-la-zona-de-trabajo.html"><i class="fa fa-check"></i><b>4</b> Obtener la zona de trabajo</a>
<ul>
<li class="chapter" data-level="4.1" data-path="obtener-la-zona-de-trabajo.html"><a href="obtener-la-zona-de-trabajo.html#obtener-y-definir-termino-municipal"><i class="fa fa-check"></i><b>4.1</b> Término municipal y mínimo rectángulo que lo contiene</a></li>
<li class="chapter" data-level="4.2" data-path="obtener-la-zona-de-trabajo.html"><a href="obtener-la-zona-de-trabajo.html#obtener-y-definir-mtn"><i class="fa fa-check"></i><b>4.2</b> Hojas del <em>Mapa Topográfico Nacional</em></a></li>
<li class="chapter" data-level="4.3" data-path="obtener-la-zona-de-trabajo.html"><a href="obtener-la-zona-de-trabajo.html#hojas-del-mapa-topográfico-de-andalucía"><i class="fa fa-check"></i><b>4.3</b> Hojas del <em>Mapa Topográfico de Andalucía</em></a></li>
<li class="chapter" data-level="4.4" data-path="obtener-la-zona-de-trabajo.html"><a href="obtener-la-zona-de-trabajo.html#obtener-y-definir-qgis"><i class="fa fa-check"></i><b>4.4</b> Operaciones en QGIS</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ortofotografía-mdt-e-información-geográfica-temática.html"><a href="ortofotografía-mdt-e-información-geográfica-temática.html"><i class="fa fa-check"></i><b>5</b> Ortofotografía, MDT e información geográfica temática</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ortofotografía-mdt-e-información-geográfica-temática.html"><a href="ortofotografía-mdt-e-información-geográfica-temática.html#centro-de-descargas-del-cnig"><i class="fa fa-check"></i><b>5.1</b> Centro de Descargas del CNIG</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ortofotografía-mdt-e-información-geográfica-temática.html"><a href="ortofotografía-mdt-e-información-geográfica-temática.html#ortofotografía"><i class="fa fa-check"></i><b>5.1.1</b> Ortofotografía</a></li>
<li class="chapter" data-level="5.1.2" data-path="ortofotografía-mdt-e-información-geográfica-temática.html"><a href="ortofotografía-mdt-e-información-geográfica-temática.html#mdt"><i class="fa fa-check"></i><b>5.1.2</b> MDT</a></li>
<li class="chapter" data-level="5.1.3" data-path="ortofotografía-mdt-e-información-geográfica-temática.html"><a href="ortofotografía-mdt-e-información-geográfica-temática.html#cartociudad-corine-land-cover"><i class="fa fa-check"></i><b>5.1.3</b> CartoCiudad, CORINE Land Cover</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ortofotografía-mdt-e-información-geográfica-temática.html"><a href="ortofotografía-mdt-e-información-geográfica-temática.html#line"><i class="fa fa-check"></i><b>5.2</b> Line@</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ortofotografía-mdt-e-información-geográfica-temática.html"><a href="ortofotografía-mdt-e-información-geográfica-temática.html#ortofotografía-1"><i class="fa fa-check"></i><b>5.2.1</b> Ortofotografía</a></li>
<li class="chapter" data-level="5.2.2" data-path="ortofotografía-mdt-e-información-geográfica-temática.html"><a href="ortofotografía-mdt-e-información-geográfica-temática.html#mdt-1"><i class="fa fa-check"></i><b>5.2.2</b> MDT</a></li>
<li class="chapter" data-level="5.2.3" data-path="ortofotografía-mdt-e-información-geográfica-temática.html"><a href="ortofotografía-mdt-e-información-geográfica-temática.html#obtener-y-definir-plano-callejero"><i class="fa fa-check"></i><b>5.2.3</b> Plano callejero</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bandas-de-satélite.html"><a href="bandas-de-satélite.html"><i class="fa fa-check"></i><b>6</b> Bandas de Satélite</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bandas-de-satélite.html"><a href="bandas-de-satélite.html#esa"><i class="fa fa-check"></i><b>6.1</b> ESA</a></li>
<li class="chapter" data-level="6.2" data-path="bandas-de-satélite.html"><a href="bandas-de-satélite.html#usgs"><i class="fa fa-check"></i><b>6.2</b> USGS</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="definir-información-geográfica.html"><a href="definir-información-geográfica.html"><i class="fa fa-check"></i><b>7</b> Definir información geográfica</a>
<ul>
<li class="chapter" data-level="7.1" data-path="definir-información-geográfica.html"><a href="definir-información-geográfica.html#crear-datos-vectoriales"><i class="fa fa-check"></i><b>7.1</b> Crear datos vectoriales</a></li>
<li class="chapter" data-level="7.2" data-path="definir-información-geográfica.html"><a href="definir-información-geográfica.html#georreferenciar-imagen"><i class="fa fa-check"></i><b>7.2</b> Georreferenciar una imagen</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i>Ejercicios</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Obtener y Definir Información Geográfica</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="obtener-la-zona-de-trabajo" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Obtener la zona de trabajo<a href="obtener-la-zona-de-trabajo.html#obtener-la-zona-de-trabajo" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A partir de la capa sobre términos municipales, vamos a obtener el polígono del término municipal de nuestro municipio. Posteriormente filtraremos los datos obtenidos para focalizarnos exclusivamente en los datos de nuestro municipio.</p>
<p>Para determinadas operaciones es interesante realizarlas sobre el rectángulo que contiene la zona de interés, por este motivo obtendremos el mínimo rectángulo que contenga al polígono del término municipal.</p>
<p>Los mapas se dividen en hojas cartográficas donde se representan los datos de las zonas que les corresponden; el número de hoja cartográfica de una zona depende de la representación que se use en el mapa. En algunos sitios web se pueden seleccionar los datos por el número de hoja cartográfica. Por este motivo, obtendremos los números de hoja según varias representaciones que contengan al rectángulo de nuestro municipio.</p>
<p>Las operaciones siguientes se pueden hacer tanto en <em>QGIS</em> como en <em>R</em>. A continuación, se muestra cómo realizarlas en <em>R</em>. En el apartado <a href="obtener-la-zona-de-trabajo.html#obtener-y-definir-qgis">4.4</a>, se indica cómo realizarlas en <em>QGIS</em><a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>.</p>
<div id="obtener-y-definir-termino-municipal" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Término municipal y mínimo rectángulo que lo contiene<a href="obtener-la-zona-de-trabajo.html#obtener-y-definir-termino-municipal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para obtener el término municipal, leemos los municipios de la capa que hemos obtenido previamente. Tenemos que comprobar que las palabras con tilde se vean correctamente. Por defecto, la función <code>st_read()</code> lee los datos en <code>UTF-8</code>. Si no se leen correctamente deberemos cambiar la codificación, generalmente a <code>WINDOWS-1252</code>, es lo que ocurre para los datos obtenidos de IDEAndalucía.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="obtener-la-zona-de-trabajo.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-2"><a href="obtener-la-zona-de-trabajo.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="obtener-la-zona-de-trabajo.html#cb1-3" tabindex="-1"></a>municipios <span class="ot">&lt;-</span></span>
<span id="cb1-4"><a href="obtener-la-zona-de-trabajo.html#cb1-4" tabindex="-1"></a>  <span class="fu">st_read</span>(<span class="st">&quot;datos/Lanjaron/dera/13_01_TerminoMunicipal.shp&quot;</span>)</span></code></pre></div>
<p>O bien:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="obtener-la-zona-de-trabajo.html#cb2-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb2-2"><a href="obtener-la-zona-de-trabajo.html#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="obtener-la-zona-de-trabajo.html#cb2-3" tabindex="-1"></a>municipios <span class="ot">&lt;-</span></span>
<span id="cb2-4"><a href="obtener-la-zona-de-trabajo.html#cb2-4" tabindex="-1"></a>  <span class="fu">st_read</span>(</span>
<span id="cb2-5"><a href="obtener-la-zona-de-trabajo.html#cb2-5" tabindex="-1"></a>    <span class="st">&quot;datos/Lanjaron/ideandalucia/Terminos municipales/shp7096744757282666625.shp&quot;</span>,</span>
<span id="cb2-6"><a href="obtener-la-zona-de-trabajo.html#cb2-6" tabindex="-1"></a>    <span class="at">options =</span> <span class="st">&quot;ENCODING=WINDOWS-1252&quot;</span></span>
<span id="cb2-7"><a href="obtener-la-zona-de-trabajo.html#cb2-7" tabindex="-1"></a>  )</span></code></pre></div>
<p>Una vez leídos los datos de los municipios, seleccionamos el nuestro y, mediante la combinación de las funciones <code>st_bbox()</code> y <code>st_as_sfc()</code>, obtenemos el mínimo rectángulo que lo contiene. Podemos comprobar el resultado mediante la función <code>plot()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="obtener-la-zona-de-trabajo.html#cb3-1" tabindex="-1"></a>lanjaron <span class="ot">&lt;-</span> municipios[municipios<span class="sc">$</span>municipio <span class="sc">==</span> <span class="st">&quot;Lanjarón&quot;</span>, ]</span>
<span id="cb3-2"><a href="obtener-la-zona-de-trabajo.html#cb3-2" tabindex="-1"></a>lanjaron_bbox <span class="ot">&lt;-</span></span>
<span id="cb3-3"><a href="obtener-la-zona-de-trabajo.html#cb3-3" tabindex="-1"></a>  <span class="fu">st_as_sfc</span>(<span class="fu">st_bbox</span>(lanjaron, <span class="at">crs =</span> <span class="fu">st_crs</span>(lanjaron)))</span>
<span id="cb3-4"><a href="obtener-la-zona-de-trabajo.html#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="obtener-la-zona-de-trabajo.html#cb3-5" tabindex="-1"></a><span class="fu">plot</span>(lanjaron_bbox)</span>
<span id="cb3-6"><a href="obtener-la-zona-de-trabajo.html#cb3-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(lanjaron), <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:web-lanjaron-bbox"></span>
<img src="figuras_original/lanjaron-bbox.png" alt="Municipio de Lanjarón y mínimo rectángulo que lo contiene." width="35%" />
<p class="caption">
Figura 4.1: Municipio de Lanjarón y mínimo rectángulo que lo contiene.
</p>
</div>
<p>En la figura <a href="obtener-la-zona-de-trabajo.html#fig:web-lanjaron-bbox">4.1</a>, se muestra el resultado para el municipio de Lanjarón.</p>
<p>Vamos a guardar las capas obtenidas en un <em>GeoPackage</em>, que puede contener varias capas. Según el CRS de la capa con la que estemos trabajando, le damos un nombre u otro a las capas.</p>
<p>Para EPSG 25830:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="obtener-la-zona-de-trabajo.html#cb4-1" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron,</span>
<span id="cb4-2"><a href="obtener-la-zona-de-trabajo.html#cb4-2" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;datos/Lanjaron/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb4-3"><a href="obtener-la-zona-de-trabajo.html#cb4-3" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">&quot;lanjaron-jsamos-25830&quot;</span>)</span>
<span id="cb4-4"><a href="obtener-la-zona-de-trabajo.html#cb4-4" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron_bbox,</span>
<span id="cb4-5"><a href="obtener-la-zona-de-trabajo.html#cb4-5" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;datos/Lanjaron/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb4-6"><a href="obtener-la-zona-de-trabajo.html#cb4-6" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">&quot;lanjaron-bbox-jsamos-25830&quot;</span>)</span></code></pre></div>
<p>Para EPSG 23030:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="obtener-la-zona-de-trabajo.html#cb5-1" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron,</span>
<span id="cb5-2"><a href="obtener-la-zona-de-trabajo.html#cb5-2" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;datos/Lanjaron/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb5-3"><a href="obtener-la-zona-de-trabajo.html#cb5-3" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">&quot;lanjaron-jsamos-23030&quot;</span>)</span>
<span id="cb5-4"><a href="obtener-la-zona-de-trabajo.html#cb5-4" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron_bbox,</span>
<span id="cb5-5"><a href="obtener-la-zona-de-trabajo.html#cb5-5" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;datos/Lanjaron/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb5-6"><a href="obtener-la-zona-de-trabajo.html#cb5-6" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">&quot;lanjaron-bbox-jsamos-23030&quot;</span>)</span></code></pre></div>
</div>
<div id="obtener-y-definir-mtn" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Hojas del <em>Mapa Topográfico Nacional</em><a href="obtener-la-zona-de-trabajo.html#obtener-y-definir-mtn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vamos a obtener un <em>shapefile</em> con las hojas del MTN (<em>Mapa Topográfico Nacional</em>), disponible en el IGN (<em>Instituto Geográfico Nacional</em>). A partir de él, obtendremos la intersección entre las hojas y el rectángulo del municipio. Aunque nos interesa obtener exclusivamente el número de las hojas, obtendremos una capa vectorial con el resultado de la operación de intersección. Cuando en una web podamos realizar consultas según el número de hoja del MTN, usaremos los números asociados a nuestro municipio consultando la capa obtenida.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:web-cnig01"></span>
<img src="figuras_original/cnig01.png" alt="Centro de Descargas del CNIG https://centrodedescargas.cnig.es/CentroDescargas." width="100%" />
<p class="caption">
Figura 4.2: Centro de Descargas del CNIG <a href="https://centrodedescargas.cnig.es/CentroDescargas">https://centrodedescargas.cnig.es/CentroDescargas</a>.
</p>
</div>
<p>En la figura <a href="obtener-la-zona-de-trabajo.html#fig:web-cnig01">4.2</a> se muestra la pantalla del Centro de Descargas del CNIG (<em>Centro Nacional de Información Geográfica</em>). Pulsando sobre el enlace <em>Información Geográfica de Referencia</em>, accedemos a distintos conjuntos de datos de referencia. Uno de ellos es el titulado “Cuadrículas cartográficas MTN25 y MTN50” (figura <a href="obtener-la-zona-de-trabajo.html#fig:web-cnig02">4.3</a>).</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:web-cnig02"></span>
<img src="figuras_original/cnig02.png" alt="Cuadrículas cartográficas MTN25 y MTN50." width="45%" />
<p class="caption">
Figura 4.3: Cuadrículas cartográficas MTN25 y MTN50.
</p>
</div>
<p>Pulsando sobre <em>Descargar</em> (figura <a href="obtener-la-zona-de-trabajo.html#fig:web-cnig02">4.3</a>), obtenemos un archivo ZIP que contiene varias capas en formato <em>Shapefile</em> con las cuadrículas MTN de referencia a escala <span class="math inline">\(1:25000\)</span> y <span class="math inline">\(1:50000\)</span>.</p>
<p>El procedimiento en ambos casos es el mismo:</p>
<ul>
<li>leer el <em>shapefile</em> de la cuadrícula con la codificación adecuada;</li>
<li>transformar la capa mediante la función <code>st_transform()</code> para que tenga el mismo CRS que la capa del rectángulo;</li>
<li>recortar la capa mediante la capa del rectángulo, mediante la función <code>st_crop()</code>.</li>
</ul>
<p>El número de las hojas se puede consultar en las variables <code>MTN25_CLAS</code> y <code>MTN50_CLAS</code>, respectivamente.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="obtener-la-zona-de-trabajo.html#cb6-1" tabindex="-1"></a>cuadricula25 <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="obtener-la-zona-de-trabajo.html#cb6-2" tabindex="-1"></a>  <span class="fu">st_read</span>(<span class="st">&quot;datos/Lanjaron/cnig/cuadriculas/MTN25_ED50_Peninsula_Baleares.shp&quot;</span>,</span>
<span id="cb6-3"><a href="obtener-la-zona-de-trabajo.html#cb6-3" tabindex="-1"></a>          <span class="at">options =</span> <span class="st">&quot;ENCODING=WINDOWS-1252&quot;</span>)</span>
<span id="cb6-4"><a href="obtener-la-zona-de-trabajo.html#cb6-4" tabindex="-1"></a>cuadricula25 <span class="ot">&lt;-</span></span>
<span id="cb6-5"><a href="obtener-la-zona-de-trabajo.html#cb6-5" tabindex="-1"></a>  <span class="fu">st_transform</span>(cuadricula25, <span class="at">crs =</span> <span class="fu">st_crs</span>(lanjaron_bbox))</span>
<span id="cb6-6"><a href="obtener-la-zona-de-trabajo.html#cb6-6" tabindex="-1"></a>lanjaron_cuadricula25 <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(cuadricula25, lanjaron_bbox)</span>
<span id="cb6-7"><a href="obtener-la-zona-de-trabajo.html#cb6-7" tabindex="-1"></a>lanjaron_cuadricula25<span class="sc">$</span>MTN25_CLAS</span>
<span id="cb6-8"><a href="obtener-la-zona-de-trabajo.html#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="obtener-la-zona-de-trabajo.html#cb6-9" tabindex="-1"></a>cuadricula50 <span class="ot">&lt;-</span></span>
<span id="cb6-10"><a href="obtener-la-zona-de-trabajo.html#cb6-10" tabindex="-1"></a>  <span class="fu">st_read</span>(<span class="st">&quot;datos/Lanjaron/cnig/cuadriculas/MTN50_ED50_Peninsula_Baleares.shp&quot;</span>,</span>
<span id="cb6-11"><a href="obtener-la-zona-de-trabajo.html#cb6-11" tabindex="-1"></a>          <span class="at">options =</span> <span class="st">&quot;ENCODING=WINDOWS-1252&quot;</span>)</span>
<span id="cb6-12"><a href="obtener-la-zona-de-trabajo.html#cb6-12" tabindex="-1"></a>cuadricula50 <span class="ot">&lt;-</span></span>
<span id="cb6-13"><a href="obtener-la-zona-de-trabajo.html#cb6-13" tabindex="-1"></a>  <span class="fu">st_transform</span>(cuadricula50, <span class="at">crs =</span> <span class="fu">st_crs</span>(lanjaron_bbox))</span>
<span id="cb6-14"><a href="obtener-la-zona-de-trabajo.html#cb6-14" tabindex="-1"></a>lanjaron_cuadricula50 <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(cuadricula50, lanjaron_bbox)</span>
<span id="cb6-15"><a href="obtener-la-zona-de-trabajo.html#cb6-15" tabindex="-1"></a>lanjaron_cuadricula50<span class="sc">$</span>MTN50_CLAS</span></code></pre></div>
<p>Para tener disponible esta información, guardamos las capas en el archivo <em>GeoPackage</em> donde hemos guardado las capas del término municipal y el rectángulo que lo contiene.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="obtener-la-zona-de-trabajo.html#cb7-1" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron_cuadricula25,</span>
<span id="cb7-2"><a href="obtener-la-zona-de-trabajo.html#cb7-2" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;datos/Lanjaron/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb7-3"><a href="obtener-la-zona-de-trabajo.html#cb7-3" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">&quot;lanjaron-cuadricula-25&quot;</span>)</span>
<span id="cb7-4"><a href="obtener-la-zona-de-trabajo.html#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="obtener-la-zona-de-trabajo.html#cb7-5" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron_cuadricula50,</span>
<span id="cb7-6"><a href="obtener-la-zona-de-trabajo.html#cb7-6" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;datos/Lanjaron/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb7-7"><a href="obtener-la-zona-de-trabajo.html#cb7-7" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">&quot;lanjaron-cuadricula-50&quot;</span>)</span></code></pre></div>
</div>
<div id="hojas-del-mapa-topográfico-de-andalucía" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Hojas del <em>Mapa Topográfico de Andalucía</em><a href="obtener-la-zona-de-trabajo.html#hojas-del-mapa-topográfico-de-andalucía" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Las hojas del <em>Mapa Topográfico de Andalucía</em> están disponibles en el cliente de descargas de IDEAndalucía.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:web-ideandalucia05"></span>
<img src="figuras_original/ideandalucia05.png" alt="Hojas del Mapa Topográfico de Andalucía en el cliente de descargas de IDEAndalucía en http://www.ideandalucia.es/clientedescarga/." width="70%" />
<p class="caption">
Figura 4.4: Hojas del <em>Mapa Topográfico de Andalucía</em> en el cliente de descargas de IDEAndalucía en <a href="http://www.ideandalucia.es/clientedescarga/">http://www.ideandalucia.es/clientedescarga/</a>.
</p>
</div>
<p>Seleccionamos las capas de las cuadrículas de distribución de las hojas (figura <a href="obtener-la-zona-de-trabajo.html#fig:web-ideandalucia05">4.4</a>) y las descargamos. A partir de ahí, el procedimiento a seguir es el mismo descrito en el apartado <a href="obtener-la-zona-de-trabajo.html#obtener-y-definir-mtn">4.2</a> para el MTN, a continuación se incluye el código.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="obtener-la-zona-de-trabajo.html#cb8-1" tabindex="-1"></a>cuadricula10 <span class="ot">&lt;-</span></span>
<span id="cb8-2"><a href="obtener-la-zona-de-trabajo.html#cb8-2" tabindex="-1"></a>  <span class="fu">st_read</span>(</span>
<span id="cb8-3"><a href="obtener-la-zona-de-trabajo.html#cb8-3" tabindex="-1"></a>    <span class="st">&quot;datos/Lanjaron/ideandalucia/Cuadricula de Distribucion de Hojas 1 10.000/shp1570285905552008566.shp&quot;</span>,</span>
<span id="cb8-4"><a href="obtener-la-zona-de-trabajo.html#cb8-4" tabindex="-1"></a>    <span class="at">options =</span> <span class="st">&quot;ENCODING=WINDOWS-1252&quot;</span></span>
<span id="cb8-5"><a href="obtener-la-zona-de-trabajo.html#cb8-5" tabindex="-1"></a>  )</span>
<span id="cb8-6"><a href="obtener-la-zona-de-trabajo.html#cb8-6" tabindex="-1"></a>cuadricula10 <span class="ot">&lt;-</span></span>
<span id="cb8-7"><a href="obtener-la-zona-de-trabajo.html#cb8-7" tabindex="-1"></a>  <span class="fu">st_transform</span>(cuadricula10, <span class="at">crs =</span> <span class="fu">st_crs</span>(lanjaron_bbox))</span>
<span id="cb8-8"><a href="obtener-la-zona-de-trabajo.html#cb8-8" tabindex="-1"></a>lanjaron_cuadricula10 <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(cuadricula10, lanjaron_bbox)</span>
<span id="cb8-9"><a href="obtener-la-zona-de-trabajo.html#cb8-9" tabindex="-1"></a>lanjaron_cuadricula10<span class="sc">$</span>numero</span>
<span id="cb8-10"><a href="obtener-la-zona-de-trabajo.html#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="obtener-la-zona-de-trabajo.html#cb8-11" tabindex="-1"></a>cuadricula100 <span class="ot">&lt;-</span></span>
<span id="cb8-12"><a href="obtener-la-zona-de-trabajo.html#cb8-12" tabindex="-1"></a>  <span class="fu">st_read</span>(</span>
<span id="cb8-13"><a href="obtener-la-zona-de-trabajo.html#cb8-13" tabindex="-1"></a>    <span class="st">&quot;datos/Lanjaron/ideandalucia/Cuadricula de Distribucion de Hojas 1 100.000/shp5361996918606098348.shp&quot;</span>,</span>
<span id="cb8-14"><a href="obtener-la-zona-de-trabajo.html#cb8-14" tabindex="-1"></a>    <span class="at">options =</span> <span class="st">&quot;ENCODING=WINDOWS-1252&quot;</span></span>
<span id="cb8-15"><a href="obtener-la-zona-de-trabajo.html#cb8-15" tabindex="-1"></a>  )</span>
<span id="cb8-16"><a href="obtener-la-zona-de-trabajo.html#cb8-16" tabindex="-1"></a>cuadricula100 <span class="ot">&lt;-</span></span>
<span id="cb8-17"><a href="obtener-la-zona-de-trabajo.html#cb8-17" tabindex="-1"></a>  <span class="fu">st_transform</span>(cuadricula100, <span class="at">crs =</span> <span class="fu">st_crs</span>(lanjaron_bbox))</span>
<span id="cb8-18"><a href="obtener-la-zona-de-trabajo.html#cb8-18" tabindex="-1"></a>lanjaron_cuadricula100 <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(cuadricula100, lanjaron_bbox)</span>
<span id="cb8-19"><a href="obtener-la-zona-de-trabajo.html#cb8-19" tabindex="-1"></a>lanjaron_cuadricula100<span class="sc">$</span>numero</span>
<span id="cb8-20"><a href="obtener-la-zona-de-trabajo.html#cb8-20" tabindex="-1"></a></span>
<span id="cb8-21"><a href="obtener-la-zona-de-trabajo.html#cb8-21" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron_cuadricula10,</span>
<span id="cb8-22"><a href="obtener-la-zona-de-trabajo.html#cb8-22" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;datos/Lanjaron/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb8-23"><a href="obtener-la-zona-de-trabajo.html#cb8-23" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">&quot;lanjaron-cuadricula-10&quot;</span>)</span>
<span id="cb8-24"><a href="obtener-la-zona-de-trabajo.html#cb8-24" tabindex="-1"></a></span>
<span id="cb8-25"><a href="obtener-la-zona-de-trabajo.html#cb8-25" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> lanjaron_cuadricula100,</span>
<span id="cb8-26"><a href="obtener-la-zona-de-trabajo.html#cb8-26" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;datos/Lanjaron/lanjaron-jsamos.gpkg&quot;</span>,</span>
<span id="cb8-27"><a href="obtener-la-zona-de-trabajo.html#cb8-27" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">&quot;lanjaron-cuadricula-100&quot;</span>)</span></code></pre></div>
</div>
<div id="obtener-y-definir-qgis" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Operaciones en QGIS<a href="obtener-la-zona-de-trabajo.html#obtener-y-definir-qgis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Si se desea realizar en <em>QGIS</em> las operaciones descritas en los apartados anteriores para <em>R</em>, en el tema sobre <em>QGIS</em>, se ha mostrado cómo leer una capa, seleccionar un elemento (el municipio elegido) y guardar una capa con el formato que se desee.</p>
<p>Para obtener el mínimo rectángulo que envuelve al término municipal, se puede utilizar la operación <em>Vector &gt; Research Tools &gt; Extraer extensión de la capa…</em></p>
<p>Para recortar las capas mediante la capa del rectángulo, se puede utilizar la operación <em>Vector &gt; Geoprocessing Tools &gt; Intersección…</em></p>
<p>Con <em>QGIS</em>, el resultado ha de ser el mismo que el obtenido con <em>R</em>.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="8">
<li id="fn8"><p>Solo hay que realizarlas una vez: con <em>QGIS</em> o con <em>R</em>.<a href="obtener-la-zona-de-trabajo.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="capas-temáticas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ortofotografía-mdt-e-información-geográfica-temática.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
